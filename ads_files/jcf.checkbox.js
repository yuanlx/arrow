/*!
* JavaScript Custom Forms : Checkbox Module
*
* Copyright 2014-2015 PSD2HTML - http://psd2html.com/jcf
* Released under the MIT license (LICENSE.txt)
*
* Version: 1.2.0
*/jcf.addModule(function($){'use strict';return{name:'Checkbox',selector:'input[type="checkbox"]',options:{wrapNative:true,checkedClass:'jcf-checked',uncheckedClass:'jcf-unchecked',labelActiveClass:'jcf-label-active',fakeStructure:'<span class="jcf-checkbox"><span></span></span>'},matchElement:function(element){return element.is(':checkbox');},init:function(){this.initStructure();this.attachEvents();this.refresh();},initStructure:function(){this.doc=$(document);this.realElement=$(this.options.element);this.fakeElement=$(this.options.fakeStructure).insertAfter(this.realElement);this.labelElement=this.getLabelFor();if(this.options.wrapNative){this.realElement.appendTo(this.fakeElement).css({position:'absolute',height:'100%',width:'100%',opacity:0,margin:0});}else{this.realElement.addClass(this.options.hiddenClass);}},attachEvents:function(){this.realElement.on({focus:this.onFocus,click:this.onRealClick});this.fakeElement.on('click',this.onFakeClick);this.fakeElement.on('jcf-pointerdown',this.onPress);},onRealClick:function(e){var self=this;this.savedEventObject=e;setTimeout(function(){self.refresh();},0);},onFakeClick:function(e){if(this.options.wrapNative&&this.realElement.is(e.target)){return;}
if(!this.realElement.is(':disabled')){delete this.savedEventObject;this.stateChecked=this.realElement.prop('checked');this.realElement.prop('checked',!this.stateChecked);this.fireNativeEvent(this.realElement,'click');if(this.savedEventObject&&this.savedEventObject.isDefaultPrevented()){this.realElement.prop('checked',this.stateChecked);}else{this.fireNativeEvent(this.realElement,'change');}
delete this.savedEventObject;}},onFocus:function(){if(!this.pressedFlag||!this.focusedFlag){this.focusedFlag=true;this.fakeElement.addClass(this.options.focusClass);this.realElement.on('blur',this.onBlur);}},onBlur:function(){if(!this.pressedFlag){this.focusedFlag=false;this.fakeElement.removeClass(this.options.focusClass);this.realElement.off('blur',this.onBlur);}},onPress:function(e){if(!this.focusedFlag&&e.pointerType==='mouse'){this.realElement.focus();}
this.pressedFlag=true;this.fakeElement.addClass(this.options.pressedClass);this.doc.on('jcf-pointerup',this.onRelease);},onRelease:function(e){if(this.focusedFlag&&e.pointerType==='mouse'){this.realElement.focus();}
this.pressedFlag=false;this.fakeElement.removeClass(this.options.pressedClass);this.doc.off('jcf-pointerup',this.onRelease);},getLabelFor:function(){var parentLabel=this.realElement.closest('label'),elementId=this.realElement.prop('id');if(!parentLabel.length&&elementId){parentLabel=$('label[for="'+elementId+'"]');}
return parentLabel.length?parentLabel:null;},refresh:function(){var isChecked=this.realElement.is(':checked'),isDisabled=this.realElement.is(':disabled');this.fakeElement.toggleClass(this.options.checkedClass,isChecked).toggleClass(this.options.uncheckedClass,!isChecked).toggleClass(this.options.disabledClass,isDisabled);if(this.labelElement){this.labelElement.toggleClass(this.options.labelActiveClass,isChecked);}},destroy:function(){if(this.options.wrapNative){this.realElement.insertBefore(this.fakeElement).css({position:'',width:'',height:'',opacity:'',margin:''});}else{this.realElement.removeClass(this.options.hiddenClass);}
this.fakeElement.off('jcf-pointerdown',this.onPress);this.fakeElement.remove();this.doc.off('jcf-pointerup',this.onRelease);this.realElement.off({focus:this.onFocus,click:this.onRealClick});}};});