var createAmpViewer=function(){"use strict";function t(t,e){function n(){this.constructor=t}for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function e(t){var e,n,i,o,r=t.split(/\r?\n/),s={};r.pop();for(var a=0,c=r.length;a<c;++a)n=r[a],e=n.indexOf(":"),i=n.slice(0,e).toLowerCase(),o=n.slice(e+1).trim(),s[i]=o;return s}function n(t){return t.split(/ *; */).shift()}function i(t){return t.split(/ *; */).reduce(function(t,e){var n=e.split(/ *= */),i=n.shift(),o=n.shift();return i&&o&&(t[i]=o),t},{})}function o(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,o=void 0;i<e.length;i++)for(o in e[i])t[o]=e[i][o];return t}function r(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var i=0,o=void 0;i<e.length;i++)for(o in e[i])void 0===t[o]&&(t[o]=e[i][o]);return t}function s(t,e,n){return(t-e)/(n-e)}function a(){return St.replace(/[xy]/g,function(t){var e=16*Math.random()|0,n="x"==t?e:3&e|8;return n.toString(16)})}function c(){if(/iP(hone|od|ad)/.test(navigator.platform)){var t=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return[parseInt(t[1],10),parseInt(t[2],10),parseInt(t[3]||0,10)]}}function u(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return("/"===(t[0]||"")[0]?"/":"")+t.filter(function(t){return!["","/","//"].some(function(e){return t===e})}).map(function(t){var e="/"===t[0]?1:0,n="/"===t[t.length-1]?t.length-1:void 0;return e||n?t.substring(e,n):t}).join("/")}function p(t,e){for(var n=50,i=0,o=t;(o=o.parentNode)&&++i<n;)if(o===e)return!0;return!1}function h(t,e,n){this.nodeName=t,this.attributes=e,this.children=n,this.key=e&&e.key}function l(t,e){var n=void 0,i=void 0,o=void 0,r=void 0,s=void 0;for(s=arguments.length;s-- >2;)Dt.push(arguments[s]);for(e&&e.children&&(Dt.length||Dt.push(e.children),delete e.children);Dt.length;)if((o=Dt.pop())instanceof Array)for(s=o.length;s--;)Dt.push(o[s]);else null!=o&&o!==!0&&o!==!1&&("number"==typeof o&&(o=String(o)),r="string"==typeof o,r&&i?n[n.length-1]+=o:((n||(n=[])).push(o),i=r));var a=new h(t,e||void 0,n||xt);return Tt.vnode&&Tt.vnode(a),a}function d(t,e){if(e)for(var n in e)t[n]=e[n];return t}function f(t){return d({},t)}function m(t,e){for(var n=e.split("."),i=0;i<n.length&&t;i++)t=t[n[i]];return t}function v(t){return"function"==typeof t}function g(t){return"string"==typeof t}function y(t){var e="";for(var n in t)t[n]&&(e&&(e+=" "),e+=n);return e}function w(t,e,n){var i=e.split(".");return function(e){for(var o=e&&e.target||this,r={},s=r,a=g(n)?m(e,n):o.nodeName?o.type.match(/^che|rad/)?o.checked:o.value:e,c=0;c<i.length-1;c++)s=s[i[c]]||(s[i[c]]=!c&&t.state[i[c]]||{});s[i[c]]=a,t.setState(r)}}function b(t){!t._dirty&&(t._dirty=!0)&&1==Ht.push(t)&&(Tt.debounceRendering||Ot)(S)}function S(){var t=void 0,e=Ht;for(Ht=[];t=e.pop();)t._dirty&&q(t)}function T(t){var e=t&&t.nodeName;return e&&v(e)&&!(e.prototype&&e.prototype.render)}function D(t,e){return t.nodeName(C(t),e||Lt)}function x(t,e){return g(e)?t instanceof Text:g(e.nodeName)?!t._componentConstructor&&A(t,e.nodeName):v(e.nodeName)?!t._componentConstructor||t._componentConstructor===e.nodeName||T(e):void 0}function A(t,e){return t.normalizedNodeName===e||Ct(t.nodeName)===Ct(e)}function C(t){var e=f(t.attributes);e.children=t.children;var n=t.nodeName.defaultProps;if(n)for(var i in n)void 0===e[i]&&(e[i]=n[i]);return e}function E(t){var e=t.parentNode;e&&e.removeChild(t)}function O(t,e,n,i,o){if("className"===e&&(e="class"),"class"===e&&i&&"object"===("undefined"==typeof i?"undefined":Vt(i))&&(i=y(i)),"key"===e);else if("class"!==e||o)if("style"===e){if((!i||g(i)||g(n))&&(t.style.cssText=i||""),i&&"object"===("undefined"==typeof i?"undefined":Vt(i))){if(!g(n))for(var r in n)r in i||(t.style[r]="");for(var s in i)t.style[s]="number"!=typeof i[s]||Rt[s]?i[s]:i[s]+"px"}}else if("dangerouslySetInnerHTML"===e)i&&(t.innerHTML=i.__html||"");else if("o"==e[0]&&"n"==e[1]){var a=t._listeners||(t._listeners={});e=Ct(e.substring(2)),i?a[e]||t.addEventListener(e,U,!!It[e]):a[e]&&t.removeEventListener(e,U,!!It[e]),a[e]=i}else if("list"!==e&&"type"!==e&&!o&&e in t)P(t,e,null==i?"":i),null!=i&&i!==!1||t.removeAttribute(e);else{var c=o&&e.match(/^xlink\:?(.+)/);null==i||i===!1?c?t.removeAttributeNS("http://www.w3.org/1999/xlink",Ct(c[1])):t.removeAttribute(e):"object"===("undefined"==typeof i?"undefined":Vt(i))||v(i)||(c?t.setAttributeNS("http://www.w3.org/1999/xlink",Ct(c[1]),i):t.setAttribute(e,i))}else t.className=i||""}function P(t,e,n){try{t[e]=n}catch(i){}}function U(t){return this._listeners[t.type](Tt.event&&Tt.event(t)||t)}function M(t){if(E(t),t instanceof Element){t._component=t._componentConstructor=null;var e=t.normalizedNodeName||Ct(t.nodeName);(_t[e]||(_t[e]=[])).push(t)}}function k(t,e){var n=Ct(t),i=_t[n]&&_t[n].pop()||(e?document.createElementNS("http://www.w3.org/2000/svg",t):document.createElement(t));return i.normalizedNodeName=n,i}function L(){for(var t=void 0;t=Ft.pop();)Tt.afterMount&&Tt.afterMount(t),t.componentDidMount&&t.componentDidMount()}function N(t,e,n,i,o,r){Bt++||(qt=o&&"undefined"!=typeof o.ownerSVGElement,Wt=t&&!(Nt in t));var s=R(t,e,n,i);return o&&s.parentNode!==o&&o.appendChild(s),--Bt||(Wt=!1,r||L()),s}function R(t,e,n,i){for(var o=e&&e.attributes&&e.attributes.ref;T(e);)e=D(e,n);if(null==e&&(e=""),g(e))return t&&t instanceof Text&&t.parentNode?t.nodeValue!=e&&(t.nodeValue=e):(t&&H(t),t=document.createTextNode(e)),t;if(v(e.nodeName))return W(t,e,n,i);var r=t,s=String(e.nodeName),a=qt,c=e.children;if(qt="svg"===s||"foreignObject"!==s&&qt,t){if(!A(t,s)){for(r=k(s,qt);t.firstChild;)r.appendChild(t.firstChild);t.parentNode&&t.parentNode.replaceChild(r,t),H(t)}}else r=k(s,qt);var u=r.firstChild,p=r[Nt];if(!p){r[Nt]=p={};for(var h=r.attributes,l=h.length;l--;)p[h[l].name]=h[l].value}return!Wt&&c&&1===c.length&&"string"==typeof c[0]&&u&&u instanceof Text&&!u.nextSibling?u.nodeValue!=c[0]&&(u.nodeValue=c[0]):(c&&c.length||u)&&I(r,c,n,i,!!p.dangerouslySetInnerHTML),V(r,e.attributes,p),o&&(p.ref=o)(r),qt=a,r}function I(t,e,n,i,o){var r=t.childNodes,s=[],a={},c=0,u=0,p=r.length,h=0,l=e&&e.length,d=void 0,f=void 0,m=void 0,v=void 0;if(p)for(var g=0;g<p;g++){var y=r[g],w=y[Nt],b=l?(f=y._component)?f.__key:w?w.key:null:null;null!=b?(c++,a[b]=y):(Wt||o||w||y instanceof Text)&&(s[h++]=y)}if(l)for(var S=0;S<l;S++){m=e[S],v=null;var T=m.key;if(null!=T)c&&T in a&&(v=a[T],a[T]=void 0,c--);else if(!v&&u<h)for(d=u;d<h;d++)if(f=s[d],f&&x(f,m)){v=f,s[d]=void 0,d===h-1&&h--,d===u&&u++;break}v=R(v,m,n,i),v&&v!==t&&(S>=p?t.appendChild(v):v!==r[S]&&(v===r[S+1]&&E(r[S]),t.insertBefore(v,r[S]||null)))}if(c)for(var D in a)a[D]&&H(a[D]);for(;u<=h;)v=s[h--],v&&H(v)}function H(t,e){var n=t._component;if(n)j(n,!e);else{t[Nt]&&t[Nt].ref&&t[Nt].ref(null),e||M(t);for(var i=void 0;i=t.lastChild;)H(i,e)}}function V(t,e,n){var i=void 0;for(i in n)e&&i in e||null==n[i]||O(t,i,n[i],n[i]=void 0,qt);if(e)for(i in e)"children"===i||"innerHTML"===i||i in n&&e[i]===("value"===i||"checked"===i?t[i]:n[i])||O(t,i,n[i],n[i]=e[i],qt)}function _(t){var e=t.constructor.name,n=jt[e];n?n.push(t):jt[e]=[t]}function F(t,e,n){var i=new t(e,n),o=jt[t.name];if(z.call(i,e,n),o)for(var r=o.length;r--;)if(o[r].constructor===t){i.nextBase=o[r].nextBase,o.splice(r,1);break}return i}function B(t,e,n,i,o){t._disable||(t._disable=!0,(t.__ref=e.ref)&&delete e.ref,(t.__key=e.key)&&delete e.key,!t.base||o?t.componentWillMount&&t.componentWillMount():t.componentWillReceiveProps&&t.componentWillReceiveProps(e,i),i&&i!==t.context&&(t.prevContext||(t.prevContext=t.context),t.context=i),t.prevProps||(t.prevProps=t.props),t.props=e,t._disable=!1,n!==Pt&&(n!==Ut&&Tt.syncComponentUpdates===!1&&t.base?b(t):q(t,Ut,o)),t.__ref&&t.__ref(t))}function q(t,e,n,i){if(!t._disable){var o=void 0,r=void 0,s=t.props,a=t.state,c=t.context,u=t.prevProps||s,p=t.prevState||a,h=t.prevContext||c,l=t.base,m=t.nextBase,g=l||m,y=t._component,w=void 0,b=void 0;if(l&&(t.props=u,t.state=p,t.context=h,e!==Mt&&t.shouldComponentUpdate&&t.shouldComponentUpdate(s,a,c)===!1?o=!0:t.componentWillUpdate&&t.componentWillUpdate(s,a,c),t.props=s,t.state=a,t.context=c),t.prevProps=t.prevState=t.prevContext=t.nextBase=null,t._dirty=!1,!o){for(t.render&&(r=t.render(s,a,c)),t.getChildContext&&(c=d(f(c),t.getChildContext()));T(r);)r=D(r,c);var S=r&&r.nodeName,x=void 0,A=void 0;if(v(S)){var E=C(r);w=y,w&&w.constructor===S&&E.key==w.__key?B(w,E,Ut,c):(x=w,w=F(S,E,c),w.nextBase=w.nextBase||m,w._parentComponent=t,t._component=w,B(w,E,Pt,c),q(w,Ut,n,!0)),A=w.base}else b=g,x=y,x&&(b=t._component=null),(g||e===Ut)&&(b&&(b._component=null),A=N(b,r,c,n||!l,g&&g.parentNode,!0));if(g&&A!==g&&w!==y){var O=g.parentNode;O&&A!==O&&(O.replaceChild(A,g),x||(g._component=null,H(g)))}if(x&&j(x,A!==g),t.base=A,A&&!i){for(var P=t,U=t;U=U._parentComponent;)(P=U).base=A;A._component=P,A._componentConstructor=P.constructor}}!l||n?Ft.unshift(t):o||(t.componentDidUpdate&&t.componentDidUpdate(u,p,h),Tt.afterUpdate&&Tt.afterUpdate(t));var M=t._renderCallbacks,k=void 0;if(M)for(;k=M.pop();)k.call(t);Bt||i||L()}}function W(t,e,n,i){for(var o=t&&t._component,r=o,s=t,a=o&&t._componentConstructor===e.nodeName,c=a,u=C(e);o&&!c&&(o=o._parentComponent);)c=o.constructor===e.nodeName;return o&&c&&(!i||o._component)?(B(o,u,kt,n,i),t=o.base):(r&&!a&&(j(r,!0),t=s=null),o=F(e.nodeName,u,n),t&&!o.nextBase&&(o.nextBase=t,s=null),B(o,u,Ut,n,i),t=o.base,s&&t!==s&&(s._component=null,H(s))),t}function j(t,e){Tt.beforeUnmount&&Tt.beforeUnmount(t);var n=t.base;t._disable=!0,t.componentWillUnmount&&t.componentWillUnmount(),t.base=null;var i=t._component;if(i)j(i,e);else if(n){n[Nt]&&n[Nt].ref&&n[Nt].ref(null),t.nextBase=n,e&&(E(n),_(t));for(var o=void 0;o=n.lastChild;)H(o,!e)}t.__ref&&t.__ref(null),t.componentDidUnmount&&t.componentDidUnmount()}function z(t,e){this._dirty=!0,this.context=e,this.props=t,this.state||(this.state={})}function K(t,e,n){return N(n,t,{},!1,e)}function Y(t){var e=document.createElement("a");e.href=t;var n=new RegExp(e.protocol+"//(.*)@");return n.test(t)&&(e.auth=n.exec(t)[1]),new Yt(e)}function X(t,e,n){return t/=n,-e*t*(t-2)}function Q(t,e,n){return e*(t/n)}function G(e){void 0===e&&(e={});var n=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n}(pe);return o(n.prototype,e),new n}function J(t){if("undefined"!=typeof t.stacktrace||"undefined"!=typeof t["opera#sourceloc"])return et(t);if(t.stack&&t.stack.match(Ne))return Z(t);if(t.stack)return tt(t);throw new Error("Cannot parse given Error object")}function $(t){if(t.indexOf(":")===-1)return[t];var e=/(.+?)(?:\:(\d+))?(?:\:(\d+))?$/,n=e.exec(t.replace(/[\(\)]/g,""));return[n[1],n[2]||void 0,n[3]||void 0]}function Z(t){var e=t.stack.split("\n").filter(function(t){return!!t.match(Ne)});return e.map(function(t){t.indexOf("(eval ")>-1&&(t=t.replace(/eval code/g,"eval").replace(/(\(eval at [^\()]*)|(\)\,.*$)/g,""));var e=t.replace(/^\s+/,"").replace(/\(eval code/g,"(").split(/\s+/).slice(1),n=$(e.pop()),i=e.join(" ")||void 0,o=["eval","<anonymous>"].indexOf(n[0])>-1?void 0:n[0];return new ke({functionName:i,fileName:o,lineNumber:n[1],columnNumber:n[2],source:t})})}function tt(t){var e=t.stack.split("\n").filter(function(t){return!t.match(Re)});return e.map(function(t){if(t.indexOf(" > eval")>-1&&(t=t.replace(/ line (\d+)(?: > eval line \d+)* > eval\:\d+\:\d+/g,":$1")),t.indexOf("@")===-1&&t.indexOf(":")===-1)return new ke({functionName:t});var e=t.split("@"),n=$(e.pop()),i=e.join("@")||void 0;return new ke({functionName:i,fileName:n[0],lineNumber:n[1],columnNumber:n[2],source:t})})}function et(t){return!t.stacktrace||t.message.indexOf("\n")>-1&&t.message.split("\n").length>t.stacktrace.split("\n").length?nt(t):t.stack?ot(t):it(t)}function nt(t){for(var e=/Line (\d+).*script (?:in )?(\S+)/i,n=t.message.split("\n"),i=[],o=2,r=n.length;o<r;o+=2){var s=e.exec(n[o]);s&&i.push(new ke({fileName:s[2],lineNumber:+s[1],source:n[o]}))}return i}function it(t){for(var e=/Line (\d+).*script (?:in )?(\S+)(?:: In function (\S+))?$/i,n=t.stacktrace.split("\n"),i=[],o=0,r=n.length;o<r;o+=2){var s=e.exec(n[o]);s&&i.push(new ke({functionName:s[3]||void 0,fileName:s[2],lineNumber:+s[1],source:n[o]}))}return i}function ot(t){var e=t.stack.split("\n").filter(function(t){return!!t.match(Le)&&!t.match(/^Error created at/)});return e.map(function(t){var e,n=t.split("@"),i=$(n.pop()),o=n.shift()||"",r=o.replace(/<anonymous function(: (\w+))?>/,"$2").replace(/\([^\)]*\)/g,"")||void 0;o.match(/\(([^\)]*)\)/)&&(e=o.replace(/^[^\(]+\(([^\)]*)\)$/,"$1"));var s=void 0===e||"[arguments not available]"===e?void 0:e.split(",");return new ke({functionName:r,args:s,fileName:i[0],lineNumber:i[1],columnNumber:i[2],source:t})})}var rt=function(t){return btoa(t)},st=function(t){return atob(t)},at=function(t,e,n){var i=t.document.readyState,o=t.document.documentElement.doScroll;t.parent!==t&&(n=!0),n||(o?/^loaded|^c/:/^loaded|^i|^c/).test(i)?t.setTimeout(function(){return e()},0):t.document.addEventListener("DOMContentLoaded",function(){return e()})},ct=function(){function t(t){this.req=t,this.xhr=this.req.xhr,this.text="HEAD"!==this.req.method&&(""===this.xhr.responseType||"text"===this.xhr.responseType)||"undefined"==typeof this.xhr.responseType?this.xhr.responseText:null,this.statusText=this.req.xhr.statusText,this.setStatusProperties(this.xhr.status),this.header=this.headers=e(this.xhr.getAllResponseHeaders()),this.header["content-type"]=this.xhr.getResponseHeader("content-type"),this.setHeaderProperties(),this.body="HEAD"!==this.req.method?this.parseBody(this.text?this.text:this.xhr.response):null}return t.prototype.setStatusProperties=function(t){var e=t/100|0;this.status=this.statusCode=t,this.statusType=e,this.info=1===e,this.ok=2===e,this.clientError=4===e,this.serverError=5===e,this.error=(4===e||5===e)&&this.toError(),this.accepted=202===t,this.noContent=204===t,this.badRequest=400===t,this.unauthorized=401===t,this.notAcceptable=406===t,this.notFound=404===t,this.forbidden=403===t},t.prototype.setHeaderProperties=function(){var t=this.header["content-type"]||"";this.type=n(t);var e=i(t);for(var o in e)this[o]=e[o]},t.prototype.parseBody=function(t){try{return JSON.parse(t)}catch(e){return null}},t.prototype.toError=function(){var t=this.req,e=t.method,n=t.url,i="cannot "+e+" "+n+" ("+this.status+")",o=new Error(i);return o.status=this.status,o.method=e,o.url=n,o},t}(),ut=function(){function t(e){void 0===e&&(e={}),this.details=e,this.details.method=this.details.method||t.methods.GET,this.details.headers=this.details.headers||{},this.details.query=this.details.query||{}}return t.prototype.send=function(t){this.details.body=this.details.body||{},this.startDate=new Date;for(var e in t)this.details.body[e]=t[e];return this},t.prototype.withCredentials=function(){return this.details.withCredentials=!0,this},t.prototype.query=function(t,e){if("string"!=typeof t)for(var n in t)this.details.query[n]=t[n];else this.details.query[t]=e;return this},t.prototype.getQueryString=function(){var t=this.details.query,e=Object.keys(t).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t[e])}).join("&");return""+(e?"?":"")+e},t.prototype.end=function(t){var e=this.details,n=this.xhr=this.getXHR(),i=""+e.url+this.getQueryString(),o=e.body?JSON.stringify(e.body):null;n.onreadystatechange=this.getXhrReadyStateChange(n,t),e.username&&e.password?n.open(e.method,i,!0,e.username,e.password):n.open(e.method,i,!0),this.details.withCredentials&&(n.withCredentials=!0);for(var r in e.headers)null!==e.headers[r]&&n.setRequestHeader(r,e.headers[r]);return n.send(o),this},t.prototype.getXHR=function(){if(window.XMLHttpRequest&&(!window.location||"file:"!==window.location.protocol||!window.ActiveXObject))return new XMLHttpRequest;try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}throw Error("Could not get XHR")},t.prototype.timedOut=function(){return!1},t.prototype.aborted=function(){return!1},t.prototype.getXhrReadyStateChange=function(t,e){var n=this;return function(){if(4===t.readyState){var i;try{i=t.status}catch(o){i=0}if(0===i){if(n.timedOut())return void e(new pt((new Date).valueOf()-n.startDate.valueOf()));if(n.aborted())return;return void e(new ht(n))}var r;try{r=new ct(n)}catch(o){return void e(new lt(n.xhr))}var s;try{(r.status<200||r.status>=300)&&(s=new Error(r.statusText||"Unsuccessful HTTP response"),s.response=r,s.status=r.status)}catch(o){s=o}s?e(s,r):e(null,r)}}},t.prototype.set=function(t,e){return this.details.headers[t]=e,this},t}();ut.methods={GET:"GET",POST:"POST",PATCH:"PATCH",PUT:"PUT",DELETE:"DELETE"};var pt=function(e){function n(t){return e.call(this,"Timeout of "+t+"ms exceeded")||this}return t(n,e),n}(Error),ht=function(e){function n(t){var n=e.call(this,"Request has been terminated\nPossible causes: the network is offline, Origin is not allowed by Access-Control-Allow-Origin, the page is being unloaded, etc.")||this;return n.status=t.details.status,n.method=t.details.method,n.url=t.details.url,n}return t(n,e),n}(Error),lt=function(e){function n(t){var n=e.call(this,"Parser is unable to parse the response")||this;return n.parse=!0,n.rawResponse=t&&t.responseText?t.responseText:null,n.statusCode=t&&t.status?t.status:null,n}return t(n,e),n}(Error),dt={get:function(t){return new ut({url:t,method:ut.methods.GET})},post:function(t){return new ut({url:t,method:ut.methods.POST})},patch:function(t){return new ut({url:t,method:ut.methods.PATCH})},put:function(t){return new ut({url:t,method:ut.methods.PUT})},del:function(t){return new ut({url:t,method:ut.methods.DELETE})}},ft=at,mt=dt,vt=function(t){return t},gt="true",yt=function(t){return t===gt},wt=function(t){try{return JSON.parse(st(t))}catch(e){return{}}},bt=function(t){var e=t.indexOf("://")+3;if(e<3)return"";var n=t.indexOf("/",e);return n===-1&&(n=void 0),t.substring(e,n)},St="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx",Tt={},Dt=[],xt=[],At={},Ct=function(t){return At[t]||(At[t]=t.toLowerCase())},Et="undefined"!=typeof Promise&&Promise.resolve(),Ot=Et?function(t){Et.then(t)}:setTimeout,Pt=0,Ut=1,Mt=2,kt=3,Lt={},Nt="undefined"!=typeof Symbol?Symbol["for"]("preactattr"):"__preactattr_",Rt={boxFlex:1,boxFlexGroup:1,columnCount:1,fillOpacity:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,fontWeight:1,lineClamp:1,lineHeight:1,opacity:1,order:1,orphans:1,strokeOpacity:1,widows:1,zIndex:1,zoom:1},It={blur:1,error:1,focus:1,load:1,resize:1,scroll:1},Ht=[],Vt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_t={},Ft=[],Bt=0,qt=!1,Wt=!1,jt={};d(z.prototype,{linkState:function(t,e){var n=this._linkedStates||(this._linkedStates={});return n[t+e]||(n[t+e]=w(this,t,e))},setState:function(t,e){var n=this.state;this.prevState||(this.prevState=f(n)),d(n,v(t)?t(n,this.props):t),e&&(this._renderCallbacks=this._renderCallbacks||[]).push(e),b(this)},forceUpdate:function(){q(this,Mt)},render:function(){}});var zt={origin:"https://amp.cloudflare.com",documentPath:"v",cdnDocPath:"c",securePath:"s",testMountPath:"/cdn",ampDocViewerPath:"_amp"},Kt=function(){function t(){Object.defineProperty(this,"listeners",{enumerable:!1,writable:!0,configurable:!0,value:[]}),Object.defineProperty(this,"evtListeners",{enumerable:!1,writable:!0,configurable:!0,value:{}}),this.disableBatchMode()}return t.prototype.enableBatchMode=function(){Object.defineProperty(this,"isInBatchUpdate",{enumerable:!1,configurable:!0,value:!0})},t.prototype.disableBatchMode=function(){Object.defineProperty(this,"isInBatchUpdate",{enumerable:!1,configurable:!0,value:!1})},t.prototype.batch=function(t){return this.enableBatchMode(),t(this),this.disableBatchMode(),this.emitChange(),this},t.prototype.emitChange=function(){if(this.isInBatchUpdate)return this;for(var t=0;t<this.listeners.length;t++)this.listeners[t](this);return this},t.prototype.on=function(t,e){return Array.isArray(this.evtListeners[t])||(this.evtListeners[t]=[]),this.evtListeners[t].push(e),this},t.prototype.off=function(t,e){return Array.isArray(this.evtListeners[t])?(this.evtListeners[t]=this.evtListeners[t].filter(function(t){return t!==e}),this):this},t.prototype.once=function(t,e){var n=function(){e.apply(null,arguments),this.off(t,n)}.bind(this);return this.on(t,n)},t.prototype.emit=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return(this.evtListeners[t]||[]).forEach(function(t){return t.apply(null,e)}),this},t.prototype.onChange=function(t){return this.listeners.push(t),this},t.prototype.removeEventListener=function(t){return this.listeners=this.listeners.filter(function(e){return e!==t}),this},t}(),Yt=function(){function t(e){void 0===e&&(e={});var n=this;t.fields.forEach(function(t){n[t]=e[t]||null}),this.hash&&"#"===this.hash[0]&&(this.hash=this.hash.substring(1)),this.protocol&&":"===this.protocol[this.protocol.length-1]&&(this.protocol=this.protocol.substring(0,this.protocol.length-1))}return Object.defineProperty(t.prototype,"origin",{get:function(){return this.protocol+"://"+this.hostname+(this.port?":":"")+(this.port?this.port:"")},enumerable:!0,configurable:!0}),t}();Yt.fields=["protocol","hostname","port","pathname","search","hash","host","auth"];var Xt=function(){function t(e,n){this.options=n=r(n||{},t.defaults),this.cdn=n.cdn,this.version=n.version,this.documentPath=n.documentPath,this.securePath=n.securePath,this.canonical=e,this.parsedCanonical=Y(e),this.preferredCdnUrl=n.preferredCdnUrl,this.customMarkup=n.customMarkup}return Object.defineProperty(t.prototype,"cdnUrl",{get:function(){if(this.preferredCdnUrl){var t=this.preferredCdnUrl.replace("/c/","/"+this.documentPath+"/");return""+t+(t.indexOf("amp_js_v")===-1?this.versionQueryParam:"")}if(void 0===this.cdn)return this.canonical;var e="https"===this.protocol?"/"+this.securePath:"",n=0===this.cdn.indexOf("https://")?"https://":"http://",i=this.cdn.substring(this.cdn.indexOf(n)+n.length),o=""+n+this.canonicalHostForCdn+"."+i;return o+"/"+this.documentPath+e+"/"+this.canonicalWithoutProtocol+this.versionQueryParam},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"protocol",{get:function(){return this.canonical.substring(0,this.canonical.indexOf(":"))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canonicalWithoutProtocol",{get:function(){return this.canonical.substring(this.canonical.indexOf("://")+3)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canonicalHostForCdn",{get:function(){var t={".":"-","-":"--"};return this.parsedCanonical.hostname.replace(/\-|\./g,function(e){return t[e]||e})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"pathAtViewer",{get:function(){var t="https"===this.protocol?this.securePath+"/":"";return""+t+this.canonicalWithoutProtocol},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"host",{get:function(){var t=this.canonical.indexOf("://")+3;return this.canonical.substring(t,this.canonical.indexOf("/",t))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"versionQueryParam",{get:function(){if(void 0===this.version)return"";var e=this.version.replace(t.versionEscReg,t.versionEscChar);return(this.canonical.indexOf("?")>-1?"&":"?")+"amp_js_v="+e},enumerable:!0,configurable:!0}),t}();Xt.defaults={documentPath:zt.documentPath,securePath:zt.securePath,prerender:!1},Xt.versionKey="amp_js_v",Xt.versionEscReg=/\./g,Xt.versionEscChar="-";var Qt=function(){function t(e){this.state=t.States.Loading,this.visibilityState=t.VisibilityStates.Hidden,o(this,r(e,t.defaults)),this.parsedCdnAmpUrl=Y(this.cdnAmpUrl),this.parsedCanonicalAmpUrl=Y(this.originAmpUrl)}return t.prototype.getDocAttrsForStateChange=function(e,n,i,o){var r={};return r.distanceFromCurr=e-n,r.absDistanceFromCurr=Math.abs(r.distanceFromCurr),0===r.distanceFromCurr?(r.visibilityState=o?t.VisibilityStates.Visible:t.VisibilityStates.Prerender,this.state===t.States.NotInDOM&&(r.state=t.States.Loading),r):r.absDistanceFromCurr>i?(r.state=t.States.NotInDOM,r.visibilityState=t.VisibilityStates.Prerender,r):r.absDistanceFromCurr>0?(this.visibilityState===t.VisibilityStates.Visible?r.visibilityState=t.VisibilityStates.Hidden:r.visibilityState=t.VisibilityStates.Prerender,this.state===t.States.NotInDOM&&(r.state=t.States.Loading),r):(this.visibilityState!==t.VisibilityStates.Visible&&o&&(r.visibilityState=t.VisibilityStates.Visible),r)},t.prototype.setDocStates=function(t,e,n,i){return o(this,this.getDocAttrsForStateChange(t,e,n,i)),this},t.prototype.setFrameIdx=function(t){this.frameIdx;this.frameIdx=t},t.prototype.getViewerSrcHash=function(){return this.srcHash+("&csi="+(this.analyticsEnabled?"1":"0"))+("&visibilityState="+this.visibilityState)},t.prototype.getViewerSrc=function(){var e=this.version.replace(t.versionEscReg,t.versionEscChar),n=t.versionKey+"="+e,i="?"!==(this.parsedCdnAmpUrl.search||"")[0];return this.cdnAmpUrl.replace("/c/","/"+this.documentPath+"/")+(i?"?":"&")+n+("#"+this.getViewerSrcHash())},t.prototype.getViewerPath=function(){return u("/",this.viewerDocBasePath,"https"===this.parsedCanonicalAmpUrl.protocol?this.viewerDocSecurePathComponent:"",this.originAmpUrl.substring(this.originAmpUrl.indexOf("://")+3))},t.prototype.toJSON=function(){var e=this;return t.attrKeys.reduce(function(t,n){return t[n]=e[n],t},{})},t}();Qt.defaults={version:"1.4.71",documentPath:zt.documentPath,viewerDocBasePath:zt.ampDocViewerPath||"/",viewerDocSecurePathComponent:zt.securePath||"",analyticsEnabled:!1,srcHash:"cid=1&dialog=0&prerenderSize=1&viewportType=natural&paddingTop=0&history=1&p2r=0&horizontalScrolling=0&storage=1"},Qt.attrKeys=["cdnAmpUrl","originAmpUrl","canonicalUrl","version","documentPath","viewerDocBasePath","viewerDocSecurePathComponent","srcHash","analyticsEnabled"],Qt.versionKey="amp_js_v",Qt.versionEscReg=/\./g,Qt.versionEscChar="-",Qt.States={Loading:"loading",Loaded:"loaded",NotInDOM:"notindom"},Qt.VisibilityStates={Prerender:"prerender",Visible:"visible",Hidden:"hidden",Paused:"paused",Inactive:"inactive"};var Gt=(function(e){function n(){return e.call(this,"Missing argument: `document`")||this}return t(n,e),n}(Error),function(e){function n(){return e.call(this,"Missing argument: `window`")||this}return t(n,e),n}(Error)),Jt=function(e){function n(){return e.call(this,"The argument provided as canonical url is invalid")||this}return t(n,e),n}(TypeError),$t=function(e){function n(t,i){void 0===t&&(t={}),void 0===i&&(i={});var s=e.call(this)||this;return s.attrs={},s.options=i,o(s.attrs,r(t,n.defaults)),s.attrs.urls=(s.attrs.urls||[]).map(function(t){return s.convertUrl(t)}),s.attrs.docs=(s.attrs.docs||[]).map(function(t){return s.convertDoc(t)}),s.attrs.urlLoadingMap=n.getMapFromAmpLinks(s.attrs.urls),s.onVisibilityTimeout=s.onVisibilityTimeout.bind(s),s.onOpenAnimationTimeout=s.onOpenAnimationTimeout.bind(s),s.onCloseAnimationTimeout=s.onCloseAnimationTimeout.bind(s),s}return t(n,e),n.getMapFromAmpLinks=function(t){return t.reduce(function(t,e){return t[e.cdnUrl]=!0,t},{})},Object.defineProperty(n.prototype,"currentDoc",{get:function(){return this.attrs.docs[this.attrs.currentDocIdx]},enumerable:!0,configurable:!0}),n.prototype.convertUrl=function(t,e){if(void 0===e&&(e={}),t instanceof Xt)return t;if("string"==typeof t)return new Xt(t,o({cdn:this.attrs.cdn,version:this.attrs.version},e));if(t instanceof Xt)return new Xt(t.canonical,o({cdn:this.attrs.cdn,version:this.attrs.version},e));throw new Jt},n.prototype.convertDoc=function(t){if("object"==typeof t&&!(t instanceof Qt))return new Qt(t);if("string"==typeof t)return new Qt({version:this.attrs.version,analyticsEnabled:this.attrs.ampDocAnalyticsEnabled,viewerDocBasePath:this.attrs.parentDocumentViewerPrefix,cdnAmpUrl:this.getCdnUrlFromOrigin(t),canonicalUrl:t,originAmpUrl:t});if(t instanceof Qt)return new Qt({version:this.attrs.version,analyticsEnabled:this.attrs.ampDocAnalyticsEnabled,viewerDocBasePath:this.attrs.parentDocumentViewerPrefix,cdnAmpUrl:t.cdnAmpUrl,canonicalUrl:t.canonicalUrl,originAmpUrl:t.originAmpUrl});throw new Jt},n.prototype.updateCurrentDocIdx=function(t){return this.attrs.currentDocIdx===t?this:(this.attrs.currentDocIdx=t,this.applyDocStates(),this.emitChange())},n.prototype.setDocs=function(t){var e=this;return this.attrs.docs=t.map(function(t){return e.convertDoc(t)}).map(function(t,n){var i=e.attrs.docs[n];return i?(i.cdnAmpUrl===t.cdnAmpUrl&&i.state===Qt.States.Loaded&&(t.state=i.state),t):t}),this.attrs.currentDocIdx=0,this.applyDocStates(),this.emitChange(),this},n.prototype.setDocsFromDiscoveryResult=function(t){var e=this;return this.setDocs(t.map(function(t){return new Qt({cdnAmpUrl:t.cdnAmpUrl,originAmpUrl:t.ampUrl,canonicalUrl:t.originalUrl,version:e.attrs.version})}))},n.prototype.applyDocStates=function(){for(var t=this.attrs,e=t.docs,n=t.currentDocIdx,i=t.carouselCacheFrameDistance,o=0;o<e.length;o++)e[o].setDocStates(o,n,i,this.attrs.open);return this},n.prototype.setUrlsFromDiscoveryResultUrls=function(t){return this.setDocsFromDiscoveryResult(t)},n.prototype.setUrls=function(t){return this.setDocs(t)},n.prototype.toggleVisibility=function(){return this.attrs.open===!0?this.close():this.open()},n.prototype.open=function(){return this.attrs.open===!0?this:("function"==typeof this.options.onBeforeOpen&&this.options.onBeforeOpen(this),this.animationTimeout&&clearTimeout(this.animationTimeout),0===this.attrs.animationDuration?(this.onOpenAnimationTimeout(),this):(this.attrs.visibilitySetup=!0,this.emitChange(),this.animationTimeout=setTimeout(this.onVisibilityTimeout,this.attrs.visibilitySetupDuration),this))},n.prototype.close=function(){return this.attrs.open===!1?this:(this.animationTimeout&&clearTimeout(this.animationTimeout),0===this.attrs.animationDuration?(this.onCloseAnimationTimeout(),this):(this.attrs.exitingDOM=!0,this.emitChange(),"function"==typeof this.options.onExitingDOM&&this.options.onExitingDOM(this),this.animationTimeout=setTimeout(this.onCloseAnimationTimeout,this.attrs.animationDuration),this))},n.prototype.next=function(){return this.attrs.currentDocIdx===this.attrs.docs.length-1?this:(this.attrs.currentDocIdx++,this.applyDocStates(),this.emitChange(),void this.emit("carousel:navigation","left",this))},n.prototype.prev=function(){return 0===this.attrs.currentDocIdx?this:(this.attrs.currentDocIdx--,this.applyDocStates(),this.emitChange(),void this.emit("carousel:navigation","right",this))},n.prototype.batch=function(t){return Kt.prototype.batch.call(this,t),this},n.prototype.updateAMPDocByCdnUrl=function(t,e){var n,i;for(i=0;i<this.attrs.docs.length;i++)if(this.attrs.docs[i].cdnAmpUrl===t){n=this.attrs.docs[i];break}if(n)return this.attrs.docs[i]=e(n)||n,this.emitChange(),n},n.prototype.getCdnUrlFromOrigin=function(t){if(void 0===this.attrs.cdn)return t;var e=t.substring(t.indexOf("://")+3),n=bt(t),i={".":"-","-":"--"},o=n.replace(/\-|\./g,function(t){return i[t]||t}),r=0===t.indexOf("https://")?"/"+this.attrs.ampDocViewerSecurePath:"",s=0===this.attrs.cdn.indexOf("https://")?"https://":"http://",a=this.attrs.cdn.substring(this.attrs.cdn.indexOf(s)+s.length),c=""+s+o+"."+a;return c+"/c"+r+"/"+e},n.prototype.onVisibilityTimeout=function(){var t=this.attrs,e=t.animationDuration-t.visibilitySetupDuration;t.visibilitySetup=!1,t.enteringDOM=!0,this.emitChange(),this.animationTimeout=setTimeout(this.onOpenAnimationTimeout,e)},n.prototype.onOpenAnimationTimeout=function(){this.attrs.enteringDOM=!1,this.attrs.open=!0,this.currentDoc&&(this.currentDoc.visibilityState=Qt.VisibilityStates.Visible),delete this.animationTimeout,this.emitChange(),this.emit("open",this)},n.prototype.onCloseAnimationTimeout=function(){this.attrs.exitingDOM=!1,this.attrs.open=!1,this.currentDoc&&(this.currentDoc.visibilityState=Qt.VisibilityStates.Hidden),delete this.animationTimeout,this.emitChange(),this.emit("close",this),"function"==typeof this.options.didExitDOM&&this.options.didExitDOM(this)},n}(Kt);
$t.defaults={open:!1,currentDocIdx:0,animationDuration:450,visibilitySetupDuration:15,visibilitySetup:!1,enteringDOM:!1,exitingDOM:!1,isTouchBrowser:!0,isClosable:!0,shouldHideOverflow:!0,isAMPViewer:!0,carouselCacheFrameDistance:1,ampDocAnalyticsEnabled:!1,cdn:zt.origin,parentDocumentViewerPrefix:zt.ampDocViewerPath,ampDocViewerCdnPath:zt.cdnDocPath,ampDocViewerPath:zt.documentPath,ampDocViewerSecurePath:zt.securePath};var Zt=function(){function t(t){if(void 0===t&&(t={}),!t.window)throw new Gt;this.options=t,this.window=t.window,this.isListening=!1,this.onKeyUp=this.onKeyUp.bind(this)}return t.prototype.listen=function(){return this.isListening=!0,this.window.addEventListener(t.listenEvt,this.onKeyUp),this},t.prototype.stop=function(){return this.isListening=!1,this.window.removeEventListener(t.listenEvt,this.onKeyUp),this},t.prototype.onKeyUp=function(e){e.keyCode===t.keyCodeArrowLeft?"function"==typeof this.options.onPrevious&&this.options.onPrevious():e.keyCode===t.keyCodeArrowRight&&"function"==typeof this.options.onNext&&this.options.onNext()},t}();Zt.listenEvt="keyup",Zt.keyCodeArrowLeft=37,Zt.keyCodeArrowRight=39;var te=function(){function t(e){void 0===e&&(e={}),this.currentStep=0,this.listeners=[],this.isStopped=!1,this.options=r(e,t.defaults)}return t.prototype.stop=function(){return this.isStopped=!0,this},t.prototype.start=function(t){return this.options.startValue=t,this},t.prototype.end=function(t){return this.options.endValue=t,this},t.prototype.easing=function(t){return this.options.easing=t,this},t.prototype.duration=function(t){return this.options.duration=t,this},t.prototype.onTick=function(t){return this.listeners.push(t),this},t.prototype.execute=function(t){return this.startTime=this.options.now(),this.next(t),this},t.prototype.next=function(t){var e=this;this.options.timingFunction(function(n){return e._onTick(n,t)})},t.prototype._onTick=function(t,e){if(this.isStopped)return void("function"==typeof e&&e());var n=Math.min(t-this.startTime,this.options.duration);this.currentValue=this.options.startValue+this.options.easing(n,this.options.endValue-this.options.startValue,this.options.duration);for(var i=0;i<this.listeners.length;i++)this.listeners[i](this.currentValue,this.currentStep);return this.currentStep++,n===this.options.duration?void("function"==typeof e&&e()):void this.next(e)},t}();te.defaults={duration:300,easing:Q};var ee=function(e){function n(t){void 0===t&&(t={});var n=this,i="performance"in window?performance.now.bind(performance):function(t){return function(){return t-(new Date).valueOf()}}((new Date).valueOf());return n=e.call(this,r(t,{now:i,timingFunction:"requestAnimationFrame"in window?requestAnimationFrame.bind(window):function(t){return setTimeout(function(){return t(i())},0)}}))||this}return t(n,e),n}(te),ne='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 125" style="enable-background:new 0 0 100 100;" xml:space="preserve"><path d="M88.8,77.5L60.6,49.3l28.2-28.2c1.2-1.2,1.2-3.1,0-4.2l-8.5-8.5L50,38.7L19.6,8.3l-8.5,8.5c-1.2,1.2-1.2,3.1,0,4.2  l28.2,28.2L11.2,77.5c-1.2,1.2-1.2,3.1,0,4.2l8.5,8.5L50,59.9l30.4,30.4l8.5-8.5C90,80.6,90,78.7,88.8,77.5z"/></svg>',ie=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.shouldComponentUpdate=function(){return!1},n.prototype.render=function(t){return l("span",{className:"amp-viewer-icon amp-viewer-icon-close",dangerouslySetInnerHTML:{__html:ne},onClick:t.onClick})},n}(z),oe=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.render=function(t){return l("ul",{className:"amp-viewer-url-indicator"},Array.apply(null,Array(t.length)).map(function(e,n){return l("li",{className:{"amp-viewer-url-indicator-active":t.activeIdx===n}})}))},n}(z),re=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.render=function(t){return l("div",{className:n.baseClass},t.href?l("a",{href:t.href,target:"_blank"},t.host):t.host)},n}(z);re.baseClass="amp-viewer-header-host";var se=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.shouldComponentUpdate=function(t){var e=this.props.currentDocIdx,n=t.currentDocIdx;return t.animationStep!==this.props.animationStep||t.docs[n]!==this.props.docs[e]},n.prototype.render=function(t){var e=void 0!==t.animationStep&&{"-webkit-transform":"translate3d(0, "+51*-t.animationStep+"px, 0)"},i={className:n.baseClass+"-main"};return"function"==typeof t.headerTmpl&&(i.dangerouslySetInnerHTML={__html:t.headerTmpl(t)}),l("div",{className:n.baseClass,style:e},t.isClosable?l(ie,{onClick:t.onCloseRequest}):null,l("div",i,"function"!=typeof t.headerTmpl&&(t.docs[t.currentDocIdx]?l(re,{host:t.docs[t.currentDocIdx].parsedCanonicalAmpUrl.host,href:t.docs[t.currentDocIdx].canonicalUrl}):null),"function"!=typeof t.headerTmpl&&(t.docs.length>1?l(oe,{length:t.docs.length||0,activeIdx:t.currentDocIdx}):null)))},n}(z);se.baseClass="amp-viewer-header";var ae=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return t(n,e),n.prototype.shouldComponentUpdate=function(){return!1},n.prototype.render=function(){return l("div",{className:"amp-viewer-loading-indicator",dangerouslySetInnerHTML:{__html:this.getMarkup()}})},n.prototype.getMarkup=function(){var t=this.props.size/2,e=Math.floor((this.props.size-this.props.strokeWidth)/2);return'\n      <svg\n        xmlns="http://www.w3.org/2000/svg"\n        width="'+this.props.size+'"\n        height="'+this.props.size+'"\n        viewBox="0 0 '+this.props.size+" "+this.props.size+'"\n      >\n        <circle\n          class="amp-viewer-loading-indicator-circle"\n          cx="'+t+'"\n          cy="'+t+'"\n          r="'+e+'"\n        />\n      </svg>\n    '},n}(z);ae.defaultProps={size:40,strokeWidth:3};var ce=function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.setVisibilityStateOnceLoaded=!1,t.shouldEnableIframeScrolling=!0,t}return t(n,e),n.getStyleAtStep=function(t){if(t.doc.state===Qt.States.NotInDOM)return n.styleDisplayNone;var e=t.transitionStep+t.doc.distanceFromCurr,i={transform:""};if(0===t.doc.distanceFromCurr){var o=Math.abs(e);i.transform="translate3d("+100*e+"%, 0, 0) scale("+(1-.2*o)+")",i.opacity=""+(1-.5*o)}else i.transform="translate3d("+100*e+"%, 0, 0)";return i["-webkit-transform"]=i.transform,i},n.prototype.componentWillUpdate=function(t){if(t.doc.cdnAmpUrl!==this.prevUrl){var e=this.getIframe();e&&this.base&&(this.base.removeChild(e),delete this.prevSrc)}},n.prototype.componentWillMount=function(){var t=c();this.shouldEnableIframeScrolling=!Array.isArray(t)||"number"!=typeof t[0]},n.prototype.componentWillReceiveProps=function(t){var e=t.doc;if(this.prevVisibilityState!==e.visibilityState||this.setVisibilityStateOnceLoaded)if(e.state===Qt.States.Loaded){this.setVisibilityStateOnceLoaded=!1;var n=this.getIframe();n&&n.contentWindow&&n.contentWindow.postMessage({type:"visibilitychange",state:e.visibilityState},"*")}else e.state===Qt.States.Loading&&(this.setVisibilityStateOnceLoaded=!0)},n.prototype.render=function(t){var e=t.doc,i=this.prevSrc||e.getViewerSrc(),r=t.iframeHeight?{height:t.iframeHeight}:{},s=e.state!==Qt.States.Loaded;return this.prevUrl=e.cdnAmpUrl,this.prevSrc=i,this.prevAmpDocState=e.state,this.prevVisibilityState=e.visibilityState,l("div",{"class":{"amp-viewer-frame":!0,"amp-viewer-frame-active":0===e.absDistanceFromCurr,"amp-viewer-frame-is-loading":s},style:n.getStyleAtStep(t)},l("div",{"class":{"amp-viewer-frame-loading":!0,"amp-viewer-frame-loading-active":s}},l(ae,null)),e.state!==Qt.States.NotInDOM?l("iframe",{src:i,"data-cdn-url":e.cdnAmpUrl,style:o(r,s?n.pointerEventsNone:{}),scrolling:this.shouldEnableIframeScrolling?"yes":"no",allowFullScreen:!0}):null)},n.prototype.getIframe=function(){return this.base.getElementsByTagName("iframe")[0]},n}(z);ce.pointerEventsNone={"pointer-events":"none"},ce.styleDisplayNone={display:"none"},ce.translate100="translate(100%, 0, 0)",ce.translateMinus100="translate(-100%, 0, 0)",ce.overflowHidden={overflow:"hidden"};var ue=function(){function t(t){o(this,t||{})}return t}(),pe=function(){function t(t){void 0===t&&(t={}),o(this,r(t,this.constructor.defaults))}return t.prototype.requestStop=function(t){return new he(t)},t.prototype.tween=function(){return this.currentTween=new te},t.prototype.onTouchStart=function(t){},t.prototype.onTouchMove=function(t){return t.animationStep},t.prototype.onTouchEnd=function(t){},t}();pe.defaults={};var he=function(){function t(t){this.value=t}return t}(),le=function(){function t(){this.plugins=[]}return t.prototype.add=function(t){return Array.isArray(t)?this.plugins=this.plugins.concat(t):this.plugins.push(t),this},t.prototype.runOnTouchStart=function(t){for(var e=0;e<this.plugins.length;e++)this.plugins[e].onTouchStart(t)},t.prototype.runOnTouchMove=function(t){for(var e,n=0;n<this.plugins.length;n++){if(e=this.plugins[n].onTouchMove(t),e instanceof he){if(void 0!==e.value)return e.value;break}t.prevAnimationStep=t.animationStep,t.animationStep=e}return t.animationStep},t.prototype.runOnTouchEnd=function(t){for(var e,n=0;n<this.plugins.length;n++)e=this.plugins[n].onTouchEnd(t),e instanceof te&&(this.currentTween&&(this.currentTween.isStopped||this.currentTween.stop(),delete this.currentTween),this.currentTween=e);this.currentTween&&this.currentTween.isStopped&&this.currentTween.execute()},t}(),de=function(e){function n(t){var n=e.call(this,t)||this;return n.onTouchStart=n.onTouchStart.bind(n),n.onTouchEnd=n.onTouchEnd.bind(n),n.onTouchMove=n.onTouchMove.bind(n),n.onMessageReceived=n.onMessageReceived.bind(n),n.onElementAvailable=n.onElementAvailable.bind(n),n.onWindowResize=n.onWindowResize.bind(n),n.state={transitionStep:0,prevTransitionStep:0},n}return t(n,e),n.prototype.componentDidMount=function(){this.el.addEventListener("touchstart",this.onTouchStart),this.el.addEventListener("touchmove",this.onTouchMove),this.el.addEventListener("touchend",this.onTouchEnd),window.addEventListener("message",this.onMessageReceived),window.addEventListener("resize",this.onWindowResize)},n.prototype.componentWillReceiveProps=function(t){var e=this;if(!this.state.isChangingIdx&&this.props.currentDocIdx!==t.currentDocIdx){this.setState({isChangingIdx:!0}),this.prevUrl=this.props.currentDocIdx;var n=Math.abs(this.state.transitionStep-this.state.prevTransitionStep);this.tweenStep(this.prevUrl-t.currentDocIdx,n||0,function(){e.setState({isChangingIdx:!1,transitionStep:0})})}},n.prototype.componentWillUnmount=function(){window.removeEventListener("message",this.onMessageReceived),window.removeEventListener("resize",this.onWindowResize),this.el.removeEventListener("touchstart",this.onTouchStart),this.el.removeEventListener("touchmove",this.onTouchMove),this.el.removeEventListener("touchend",this.onTouchEnd)},n.prototype.render=function(t,e){this.el&&0!==this.el.scrollLeft&&(this.el.scrollLeft=0);var n=this.getWhatIframeHeightShouldBe(),i={"-webkit-transform":"translate3d(0, "+51*-t.headerAnimationStep+"px, 0)"};return l("div",{className:"amp-viewer-body",ref:this.onElementAvailable,style:i},t.docs.map(function(i,o){return l(ce,{doc:i,key:i.cdnAmpUrl+"_"+o,transitionStep:e.transitionStep,iframeHeight:n,onIframeUnload:t.onIframeUnload})}))},n.prototype.getWidth=function(){return this.cachedWidth?this.cachedWidth:(this.cachedWidth=this.el.offsetWidth,this.cachedWidth)},n.prototype.getWhatIframeHeightShouldBe=function(){return this.cachedIFrameHeight?this.cachedIFrameHeight:(this.cachedIFrameHeight=window.innerHeight,this.cachedIFrameHeight)},n.prototype.tweenStep=function(t,e,i){var o=this;if(void 0===e&&(e=0),"number"!=typeof t||t<-1||t>1)return void(i&&i());this.tween&&this.tween.stop();var r=n.animationDuration-e*n.animationDuration;this.tween=(new ee).start(this.state.transitionStep).end(t).easing(X).duration(r).onTick(function(t){return o.setState({transitionStep:t})}).execute(function(){delete o.tween,"function"==typeof i&&i()})},n.prototype.getStepFromEvent=function(t){var e=this.getWidth(),n=e,i=t.touches[0].clientX,o=Math.max(-n,Math.min(n,this.touchStartX-i));return 0-s(o,0,n)},n.prototype.invalidateCachedProperties=function(){return delete this.cachedWidth,delete this.cachedIFrameHeight,this.setState({}),this},n.prototype.onMessageReceived=function(t){switch(t.data.type){case"onTouchMove":this.onTouchMove(t.data);break;case"onTouchStart":this.onTouchStart(t.data);break;case"onTouchEnd":"function"==typeof this.props.onTouchEnd&&this.props.onTouchEnd(t.data),this.onTouchEnd(t.data)}},n.prototype.onElementAvailable=function(t){this.el=t},n.prototype.onTouchStart=function(t){var e=this.props.carouselAnimationPlugins.currentTween;e&&!e.isStopped&&e.stop(),this.touchStartX=t.touches[0].clientX,this.props.carouselAnimationPlugins.runOnTouchStart(new ue({animationStep:this.getStepFromEvent(t),prevAnimationStep:this.state.prevTransitionStep,component:this,originalEvent:t,currentDocIdx:this.props.currentDocIdx,docs:this.props.docs}))},n.prototype.onTouchEnd=function(t){this.props.carouselAnimationPlugins.runOnTouchEnd(new ue({animationStep:this.state.transitionStep,prevAnimationStep:this.state.prevTransitionStep,component:this,originalEvent:t,currentDocIdx:this.props.currentDocIdx,docs:this.props.docs}))},n.prototype.onTouchMove=function(t){var e=this.props.carouselAnimationPlugins.runOnTouchMove(new ue({animationStep:this.getStepFromEvent(t),prevAnimationStep:this.state.prevTransitionStep,component:this,originalEvent:t,currentDocIdx:this.props.currentDocIdx,docs:this.props.docs}));this.setState({transitionStep:e,prevTransitionStep:this.state.transitionStep})},n.prototype.onWindowResize=function(t){this.invalidateCachedProperties()},n}(z);de.defaultProps={headerAnimationStep:0},de.animationDuration=250;var fe=function(e){function n(t){var n=e.call(this,t)||this;return n.startScrollTop=0,n.scrollTop=0,n.prevHeaderAnimationStep=0,n.state={headerAnimationStep:0},n.onElementAvailable=n.onElementAvailable.bind(n),n.onMessageReceived=n.onMessageReceived.bind(n),n.onScroll=n.onScroll.bind(n),n.onTouchStart=n.onTouchStart.bind(n),n.onTouchEnd=n.onTouchEnd.bind(n),n.state={headerAnimationStep:0},n}return t(n,e),n.prototype.componentWillReceiveProps=function(t){var e=this,n=this.props.currentDoc,i=t.currentDoc;n&&i&&n.cdnAmpUrl!==i.cdnAmpUrl&&(this.lastScrollDirection="Up",this.tweenToEnd(function(){e.prevHeaderAnimationStep=0}))},n.prototype.componentDidMount=function(){window.addEventListener("message",this.onMessageReceived)},n.prototype.render=function(t){var e=t.state,n=e.attrs,i={display:n.open||n.visibilitySetup||n.enteringDOM||n.exitingDOM?"block":"none"};return l("div",{className:{"amp-viewer-wrapper":!0,"amp-viewer-open":n.open,"amp-viewer-visibility-setup":n.visibilitySetup,"amp-viewer-entering-dom":n.enteringDOM,"amp-viewer-exiting-dom":n.exitingDOM,"amp-viewer-is-touch":n.isTouchBrowser},ref:this.onElementAvailable,style:i},l("div",{className:"amp-viewer"},l(se,{docs:n.docs,currentDocIdx:n.currentDocIdx,isClosable:n.isClosable,animationStep:this.state.headerAnimationStep,headerTmpl:t.headerTmpl,onCloseRequest:t.onCloseRequest}),l(de,{docs:n.docs,currentDocIdx:n.currentDocIdx,headerAnimationStep:this.state.headerAnimationStep,onTouchEnd:t.onTouchEnd,onRampUpSatisfied:t.onRampUpSatisfied,onIframeUnload:t.onIframeUnload,carouselAnimationPlugins:t.carouselAnimationPlugins})))},n.prototype.getHeaderAnimationStepFromScrollTop=function(t){var e=this.props.headerAnimationDistance,n=Math.max(0,Math.min(e,t-this.startScrollTop)),i=s(n,0,e);return i},n.prototype.tweenToEnd=function(t){var e=this,i=this.state.headerAnimationStep,o=this.lastScrollDirection,r=Math.abs(this.state.headerAnimationStep-this.prevHeaderAnimationStep),s=n.headerAnimationDuration-r*n.headerAnimationDuration,a=0===i&&"Up"===o||1===i&&"Down"===o;return a?"function"==typeof t?t():void 0:void(this.tween=(new ee).start(this.state.headerAnimationStep).end("Down"===o?1:0).easing(X).duration(s).onTick(function(t){return e.setState({headerAnimationStep:t})}).execute(function(){delete e.tween,e.captureStartScrollTop(),"function"==typeof t&&t()}))},n.prototype.onElementAvailable=function(t){this.el=t},n.prototype.onMessageReceived=function(t){switch(t.data&&t.data.type||""){case"scroll":this.onScroll(t);break;case"onTouchStart":this.onTouchStart(t.data);break;case"onTouchEnd":this.onTouchEnd(t.data)}},n.prototype.captureStartScrollTop=function(){"Up"===this.lastScrollDirection?this.startScrollTop=this.scrollTop:this.startScrollTop=Math.max(0,this.scrollTop-this.props.headerAnimationDistance-this.props.headerAnimationTravelBackUpDistance)},n.prototype.onScroll=function(t){var e=t.data.scrollTop,n=this.scrollTop;this.scrollTop=e,void 0===this.startScrollTop&&(this.startScrollTop=this.scrollTop),n-e<0?(this.lastScrollDirection="Down",1===this.state.headerAnimationStep&&this.captureStartScrollTop()):(this.lastScrollDirection="Up",0===this.state.headerAnimationStep&&this.captureStartScrollTop());var i=this.getHeaderAnimationStepFromScrollTop(this.scrollTop);this.prevHeaderAnimationStep=i;var o=!1,r=!1;this.state.headerAnimationStep>0&&0===i?o=!0:1!==this.state.headerAnimationStep&&1===i&&(r=!0),this.setState({headerAnimationStep:i}),r&&this.props.onHeaderHidden?this.props.onHeaderHidden():o&&this.props.onHeaderShown&&this.props.onHeaderShown()},n.prototype.onTouchStart=function(t){this.tween&&(this.tween.stop(),delete this.tween)},n.prototype.onTouchEnd=function(t){this.tweenToEnd()},n}(z);fe.headerAnimationDuration=300,fe.defaultProps={headerAnimationDistance:100,headerAnimationTravelBackUpDistance:100};var me=function(){function t(e){this.options=r(e||{},t.defaults),this.state=e.state,this.onStateChange=this.onStateChange.bind(this),this.state.onChange(this.onStateChange)}return t.areFramesEqual=function(t,e){return!(!Array.isArray(t)||!Array.isArray(e))&&(t.length===e.length&&t.every(function(n,i){return t[i].cdnAmpUrl===e[i].cdnAmpUrl}))},t.getAMinusBFrame=function(t,e){return t.filter(function(t,n){return!e[n]||t.cdnAmpUrl!==e[n].cdnAmpUrl})},t.getFrameFromAMPDocs=function(t,e,n){var i=Math.max(0,e-n),o=Math.min(t.length-1,e+n)+1;return t.slice(i,o)},t.prototype.getFrameFromState=function(){return t.getFrameFromAMPDocs(this.state.attrs.docs,this.state.attrs.currentDocIdx,this.options.frameDistance)},t.prototype.getAMPDocsToEmitFromFrame=function(e){if(this.currentFrame){var n=t.getAMinusBFrame(e,this.currentFrame);return n}return this.state.attrs.open?e:e.filter(function(t){return t.visibilityState===Qt.VisibilityStates.Prerender})},t.prototype.getAMPDocsExitingFrame=function(e){return t.getAMinusBFrame(this.currentFrame,e)},t.prototype.onStateChange=function(){var t=this,e=this.getFrameFromState();this.getAMPDocsToEmitFromFrame(e).forEach(function(e){return t.options.onLoadStart(e)}),void 0!==this.options.onFrameLeave&&this.currentFrame&&this.currentFrame.length>0&&this.getAMPDocsExitingFrame(e).forEach(function(e){return t.options.onFrameLeave(e)}),this.currentFrame=e},t}();me.defaults={frameDistance:1};var ve=function(){function t(e){this.options=r(e||{},t.defaults),this.state=e.state,this.onStateChange=this.onStateChange.bind(this),this.state.onChange(this.onStateChange)}return t.prototype.onStateChange=function(){var t=this.state.currentDoc;if(!t)return this.prevUrl=void 0,void(this.prevUrlWasOpen=!1);var e=this.state.attrs.open||this.state.attrs.visibilitySetup||this.state.attrs.enteringDOM;t.cdnAmpUrl!==this.prevUrl&&e?this.options.onView(this.state.currentDoc):t.cdnAmpUrl===this.prevUrl&&!this.prevUrlWasOpen&&e&&this.options.onView(this.state.currentDoc),this.prevUrl=t.cdnAmpUrl,this.prevUrlWasOpen=e},t}();ve.defaults={};var ge=function(){function t(t){this.doc=t}return t.prototype.isComplete=function(){return void 0!==this.loadStart&&void 0!==this.loadEnd&&void 0!==this.viewTime},t.prototype.toJSON=function(){return{url:this.doc.cdnAmpUrl,loadStart:this.loadStart,loadEnd:this.loadEnd,viewTime:this.viewTime}},t}(),ye=function(){function t(){this.y=0,this.minYForTrigger=1/0,this.rules=[]}return t.prototype.update=function(t){if(this.y=t,this.minYForTrigger>this.y)return this;for(var e=0,n=void 0,i=void 0;e<this.rules.length;e++){if(n=this.rules[e],n.value>t)return;for(i=0;i<n.handlers.length;i++)n.handlers[i]()}return this},t.prototype.destroy=function(){this.rules=[],this.y=0},t.prototype.getRuleIndexForY=function(t){for(var e=0;e<this.rules.length;e++)if(this.rules[e].value===t)return e;return-1},t.prototype.getOrCreateRuleAtY=function(t){var e=this.getRuleIndexForY(t);if(e>-1)return this.rules[e];var n={value:t,handlers:[]};return this.rules.push(n),this.rules=this.rules.sort(function(t,e){return t.value<e.value?-1:1}),n},t.prototype.on=function(t,e){return this.getOrCreateRuleAtY(t).handlers.push(e),t<this.minYForTrigger&&(this.minYForTrigger=t),new we(t,e)},t.prototype.once=function(t,e){var n=this;if(this.y>=t)return e(),null;var i=function(){e(),n.removeListener(t,i)};return this.on(t,i)},t.prototype.removeListener=function(t,e){if(t instanceof we)return this.removeListener(t.y,t.handler);var n=this.getRuleIndexForY(t);if(n!==-1){var i=this.rules[n];i.handlers=i.handlers.filter(function(t){return t!==e}),0===i.handlers.length&&(this.rules=this.rules.filter(function(t){return t!==i}),this.minYForTrigger=this.getMinimumYInRules())}},t.prototype.getMinimumYInRules=function(){return this.rules.reduce(function(t,e){return e.value<t?e.value:t},1/0)},t}(),we=function(){function t(t,e){this.y=t,this.handler=e}return t}(),be=function(e){function n(t){return e.call(this,t)||this}return t(n,e),n.prototype.onTouchMove=function(t){return 0===t.currentDocIdx&&t.animationStep>0?this.easing(t.animationStep,this.clampAt,1):t.currentDocIdx===t.docs.length-1&&t.animationStep<0?this.easing(t.animationStep,-this.clampAt,-1):t.animationStep},n}(pe);be.defaults={clampAt:.4,easing:X};var Se=function(e){function n(t){return e.call(this,t)||this}return t(n,e),n.prototype.onTouchEnd=function(t){var e=this,n=t.animationStep,i=Math.abs(t.animationStep-t.prevAnimationStep);return t.currentDocIdx!==t.docs.length-1&&n<=-this.navigationDistance?(t.component.setState({isChangingIdx:!0}),t.component.tweenStep(-1,i||0,function(){e.onTouchNext&&e.onTouchNext(),t.component.setState({isChangingIdx:!1,transitionStep:0})})):0!==t.currentDocIdx&&n>=this.navigationDistance?(t.component.setState({isChangingIdx:!0}),t.component.tweenStep(1,i||0,function(){e.onTouchPrev&&e.onTouchPrev(),t.component.setState({isChangingIdx:!1,transitionStep:0})})):(t.component.state.isChangingIdx&&(t.component.state.isChangingIdx=!1),t.component.tweenStep(0))},n}(pe);Se.defaults={navigationDistance:.3};var Te=function(e){function n(t){var n=e.call(this,t)||this;return n.didSurpassScrollThreshold=!1,n}return t(n,e),n.prototype.isVerticallyScrolling=function(t){var e=t.touches[0].clientY;return this.didSurpassScrollThreshold||Math.abs(this.touchStartY-e)>this.scrollThreshold},n.prototype.onTouchStart=function(t){this.touchStartY=t.originalEvent.touches[0].clientY},n.prototype.onTouchMove=function(t){var e=t.didSatisfyRampUp;return this.isVerticallyScrolling(t.originalEvent)&&!e?(this.didSurpassScrollThreshold=!0,this.requestStop(0)):t.animationStep},n.prototype.onTouchEnd=function(t){this.didSurpassScrollThreshold=!1},n}(pe);Te.defaults={scrollThreshold:20};var De=function(e){function n(t){var n=e.call(this,t)||this;return n.didStartTouch=!1,n.didSatisfyRampUp=!1,n}return t(n,e),n.prototype.onTouchStart=function(t){return this.stopOnSingleDocument&&t.docs.length<2?this.requestStop(0):void(this.didStartTouch=!0)},n.prototype.onTouchMove=function(t){if(t.didSatisfyRampUp=this.didSatisfyRampUp,!this.didStartTouch)return this.requestStop(0);var e=t.animationStep;return Math.abs(e)>this.rampUp&&!this.didSatisfyRampUp&&(this.didSatisfyRampUp=!0,"function"==typeof this.onRampUpSatisfied&&this.onRampUpSatisfied()),this.didSatisfyRampUp?t.animationStep:this.requestStop(0)},n.prototype.onTouchEnd=function(t){this.didStartTouch=!1,this.didSatisfyRampUp=!1},n}(pe);De.defaults={rampUp:.05,stopOnSingleDocument:!0};var xe=function(){function t(e){var n=this;this.numHistoryEntriesSinceOpen=0,this.isTouching=!1,this.instanceId=a(),this.ampDocReports={},this.skipNextUrlRender=!1,this.didOpenOnce=!1,this.didSendPerformanceBeacon=!1,this.options=r(e,t.defaults),this.options.cdn.indexOf("http")===-1&&(this.options.cdn="https://"+this.options.cdn),Array.isArray(this.options.domain)||(this.options.domain=[]),this.window=this.options.window,this.renderTarget=this.options.renderTarget||this.window.document.body,this.state=new $t({open:e.isOpen,cdn:e.cdn,isClosable:e.isClosable,isTouchBrowser:"ontouchstart"in this.window,version:e.version,shouldHideOverflow:e.shouldHideOverflow,parentDocumentViewerPrefix:e.parentDocumentViewerPrefix},{onBeforeOpen:function(t){n.prerenderScrollHandler&&(n.scrollListener.removeListener(n.prerenderScrollHandler),delete n.prerenderScrollHandler),n.pathPriorToOpening=n.getCurrentPath(),n.scrollPositionPriorToOpening={x:n.window.scrollX,y:n.window.scrollY}},onExitingDOM:function(e){n.renderTarget.classList.remove(t.renderTargetActiveClass);try{n.restoreMetaViewportTag()}catch(i){n.emit("log:warn",{message:"failed to restore meta viewport tag",level:"warning",extra:{message:i.message,stack:i.stack}})}n.renderTarget.classList.add("amp-viewer-exiting"),n.scrollPositionPriorToOpening&&n.window.setTimeout(function(){return n.scrollToPriorPosition()},1)},didExitDOM:function(t){if(n.renderTarget.classList.remove("amp-viewer-exiting"),n.scrollPositionPriorToOpening&&n.window.setTimeout(function(){return n.scrollToPriorPosition()},1),n.renderUrl(),!n.options.disableAnalytics){var e={type:"close",url:t.currentDoc.cdnAmpUrl};n.emit("log:analytics",e)}}}),this.state.setDocs(e.urls||[]),this.state.attrs.open&&(this.didOpenOnce=!0),this.currOpenState=this.state.attrs.open,this.keyboardEventListener=new Zt({window:this.window,onNext:function(){return n.next()},onPrevious:function(){return n.prev()}});var i=this.getCurrentPath();this.didLoadPageOnAMPDoc=!!this.state.currentDoc&&i===this.state.currentDoc.getViewerPath(),this.options.disableAnalytics||(this.docLoadStartListener=new me({state:this.state,onFrameLeave:function(t){n.ampDocReports[t.cdnAmpUrl]&&delete n.ampDocReports[t.cdnAmpUrl]},onLoadStart:function(t){n.ampDocReports[t.cdnAmpUrl]||(n.ampDocReports[t.cdnAmpUrl]=new ge(t)),n.ampDocReports[t.cdnAmpUrl].loadStart=(new Date).valueOf()}}),this.docViewListener=new ve({state:this.state,onView:function(t){var e=n.ampDocReports[t.cdnAmpUrl];e||(e=n.ampDocReports[t.cdnAmpUrl]=new ge(t)),e.viewTime=(new Date).valueOf(),e.isComplete()&&n.sendAMPDocReportBeacon(e)}})),this.scrollListener=new ye,this.scrollListener.update(this.window.scrollY),this.onStateChange=this.onStateChange.bind(this),this.onMessageReceived=this.onMessageReceived.bind(this),this.onHistoryPopState=this.onHistoryPopState.bind(this),this.onTouchNext=this.onTouchNext.bind(this),this.onTouchPrev=this.onTouchPrev.bind(this),this.onRampUpSatisfied=this.onRampUpSatisfied.bind(this),this.onTouchEnd=this.onTouchEnd.bind(this),this.onCloseRequest=this.onCloseRequest.bind(this),this.onIframeUnload=this.onIframeUnload.bind(this),this.onWindowError=this.onWindowError.bind(this),this.onScroll=this.onScroll.bind(this),this.onHeaderHidden=this.onHeaderHidden.bind(this),this.onHeaderShown=this.onHeaderShown.bind(this),this.defaultCarouselAnimationPlugins=[new be,new De({onRampUpSatisfied:this.onRampUpSatisfied}),new Te,new Se({onTouchNext:this.onTouchNext,onTouchPrev:this.onTouchPrev})],this.defaultCarouselAnimationPluginRunner=(new le).add(this.defaultCarouselAnimationPlugins),Array.isArray(this.options.carouselAnimationPlugins)||(this.options.carouselAnimationPlugins=this.defaultCarouselAnimationPlugins),this.carouselAnimationPluginsRunner=(new le).add(this.options.carouselAnimationPlugins),this.state.onChange(this.onStateChange)}return t.tween=function(){return new ee},t.carouselPlugin=function(t){return G(t)},t.prototype.init=function(t){var e=this;return t&&(this.viewerReadyCallback=t),ft(this.window,function(){return e.onDOMReady()}),this.window.addEventListener("scroll",this.onScroll),this.options.historyEnabled&&this.window.addEventListener("popstate",this.onHistoryPopState),this.options.keyboardInput&&this.keyboardEventListener.listen(),this.options.reportErrors&&(this.window.onerror&&(this.oldWindowError=this.window.onerror),this.isSafari()?this.window.onerror=function(t,n,i,o){e.onWindowError(t,n,i,o)}:this.window.onerror=this.onWindowError),this.state.attrs.open&&this.renderUrl(),this.emit("ready",this),this},t.prototype.destroy=function(){return this.state.removeEventListener(this.onStateChange),this.window.removeEventListener("popstate",this.onHistoryPopState),this.window.removeEventListener("scroll",this.onScroll),this.options.keyboardInput&&this.keyboardEventListener.stop(),this.options.reportErrors&&(this.window.onerror=this.oldWindowError),this},t.prototype.toggleVisibility=function(){return this.state.toggleVisibility(),this},t.prototype.open=function(){return this.state.open(),this},t.prototype.close=function(){return this.state.close(),this},t.prototype.next=function(){return this.state.next(),this},t.prototype.prev=function(){return this.state.prev(),this},t.prototype.setUrls=function(t){return this.state.setDocs(t),this},t.prototype.getCurrentPath=function(){var t=this.window.location;return""+t.pathname+t.search+t.hash},t.prototype.scrollToPriorPosition=function(){return this.scrollPositionPriorToOpening&&this.window.scrollTo(this.scrollPositionPriorToOpening.x,this.scrollPositionPriorToOpening.y),this},t.prototype.render=function(){return this.component=K(l(fe,{state:this.state,headerTmpl:this.options.headerTmpl,currentDoc:this.state.currentDoc,carouselAnimationPlugins:this.carouselAnimationPluginsRunner,onTouchNext:this.onTouchNext,onTouchPrev:this.onTouchPrev,onRampUpSatisfied:this.onRampUpSatisfied,onTouchEnd:this.onTouchEnd,onCloseRequest:this.onCloseRequest,onIframeUnload:this.onIframeUnload,onHeaderHidden:this.onHeaderHidden,onHeaderShown:this.onHeaderShown}),this.renderTarget,this.component&&this.component._component&&this.component._component.el),this},t.prototype.renderUrl=function(){if(this.skipNextUrlRender)return this.skipNextUrlRender=!1,this;var t=this.window.location,e=t.pathname+t.search,n=this.state.currentDoc;if(!n)return this;var i=n.getViewerPath();return this.options.historyEnabled&&(this.state.attrs.open&&!this.state.attrs.exitingDOM?e!==i&&this.pushState(i):e===i&&(this.pushState(this.pathPriorToOpening),this.didLoadPageOnAMPDoc&&setTimeout(function(){t.reload()},500))),this},t.prototype.isOpenOrOpening=function(){return this.state.attrs.open||this.state.attrs.enteringDOM},t.prototype.updateMetaViewportTag=function(){this.oldMetaTag=this.window.document.querySelector(t.metaTagViewportSelector);var e=this.createMetaViewportTag();this.oldMetaTag&&!this.oldMetaTag.isEqualNode(e)?(this.window.document.head.replaceChild(e,this.oldMetaTag),this.newMetaTag=e):this.oldMetaTag||(this.window.document.head.appendChild(e),this.newMetaTag=e)},t.prototype.restoreMetaViewportTag=function(){this.oldMetaTag?this.window.document.head.replaceChild(this.oldMetaTag,this.newMetaTag):this.window.document.head.removeChild(this.newMetaTag)},t.prototype.createMetaViewportTag=function(){var e=document.createElement("meta");return e.name=t.metaTagViewportName,e.content=t.metaTagViewportContent,e},t.prototype.pushState=function(t){if(!t)return this;var e={open:this.state.attrs.open,isAMPViewer:!0,numHistoryEntriesSinceOpen:++this.numHistoryEntriesSinceOpen};return e.open?(e.docs=this.state.attrs.docs.map(function(t){return t.toJSON()}),e.currentDocIdx=this.state.attrs.currentDocIdx,e.pathPriorToOpening=this.pathPriorToOpening):(e.docs=[],e.pathPriorToOpening=this.getCurrentPath()),this.window.history.pushState(e,"",t),
this},t.prototype.getStateFromUrl=function(t,e){var n=Y(t),i=(e||{}).docs||[],o=function(){for(var t=0;t<i.length;t++)if(new Qt(i[t]).getViewerPath()===n.pathname)return t;return-1}();return o>-1?{open:!0,currentDocIdx:o}:{open:!1}},t.prototype.getActiveIframe=function(){return this.state.currentDoc?this.renderTarget.querySelector('iframe[data-cdn-url="'+this.state.currentDoc.cdnAmpUrl+'"]'):null},t.prototype.sendMessageToActiveFrame=function(t){var e=this,n=this.getActiveIframe();return n?(this.window.setTimeout(function(){n.contentWindow&&n.contentWindow.postMessage&&n.contentWindow.postMessage(t,e.state.currentDoc.parsedCdnAmpUrl.origin)},1),this):this},t.prototype.sendDisableScrollToDocument=function(){return this.sendMessageToActiveFrame({type:"disableScrolling"})},t.prototype.sendEnableScrollToDocument=function(){return this.sendMessageToActiveFrame({type:"enableScrolling"})},t.prototype.getPerformanceData=function(){var t=this,e={type:"parentDocumentPerformanceTiming"};return["connectEnd","connectStart","domComplete","domContentLoadedEventEnd","domContentLoadedEventStart","domInteractive","domLoading","domainLookupEnd","domainLookupStart","fetchStart","loadEventEnd","loadEventStart","navigationStart","redirectEnd","redirectStart","requestStart","responseEnd","responseStart","secureConnectionStart","unloadEventEnd","unloadEventStart"].reduce(function(e,n){return e[n]=t.window.performance.timing[n],e},e)},t.prototype.maybeSendInitialPerformanceBeacon=function(){if(!this.options.disableAnalytics&&"performance"in this.window&&!this.didSendPerformanceBeacon&&Math.random()<=this.options.performanceBeaconSampleRate){this.didSendPerformanceBeacon=!0;var t=this.getPerformanceData();this.emit("log:analytics",t)}},t.prototype.testSentry=function(){setTimeout(function(){var t=new Error("Test sentry");throw t},500)},t.prototype.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(this.window.navigator.userAgent)},t.prototype.sendAMPDocReportBeacon=function(t){var e=o(t.toJSON(),{type:"ampDocumentLoaded"});this.emit("log:analytics",e),delete this.ampDocReports[t.doc.cdnAmpUrl]},t.prototype.customDocument=function(t,e){return new Qt({cdnAmpUrl:t,originAmpUrl:t,canonicalUrl:t})},t.prototype.onUrlChange=function(t){this.renderUrl()},t.prototype.onOpen=function(){if(this.renderTarget.classList.remove("amp-viewer-exiting"),this.renderTarget.classList.add(t.renderTargetActiveClass),this.updateMetaViewportTag(),this.keyboardEventListener.isListening||this.keyboardEventListener.listen(),!this.didOpenOnce&&!this.options.disableAnalytics&&"performance"in this.window&&!this.didSendPerformanceBeacon){this.didSendPerformanceBeacon=!0;var e=this.getPerformanceData();this.emit("log:analytics",e)}this.didOpenOnce=!0,this.renderUrl()},t.prototype.onClose=function(){this.pathPriorToOpening&&delete this.pathPriorToOpening,this.keyboardEventListener.isListening&&this.keyboardEventListener.stop()},t.prototype.onStateChange=function(){var t=this;if(this.currOpenState!==this.state.attrs.open&&(this.currOpenState?setTimeout(function(){return t.onClose()},0):setTimeout(function(){return t.onOpen()},0)),this.currentDoc!==this.state.currentDoc&&this.state.currentDoc){var e=this.currentDoc;this.currentDoc=this.state.currentDoc,setTimeout(function(){return t.onUrlChange(e)},0)}this.currOpenState=this.state.attrs.open,this.render()},t.prototype.onMessageReceived=function(t){if("onTouchMove"!==t.data.type){if("onTouchStart"===t.data.type)return void(this.isTouching=!0);if("onTouchEnd"===t.data.type)return void(this.isTouching=!1);if("documentLoaded"===t.data.type)return void this.onAMPRuntimeDocumentLoaded(t);if(this.state.currentDoc){var e=this.state.currentDoc.parsedCdnAmpUrl.origin;if(t.origin===e)switch(t.data.type){case"requestNextDocument":this.next();break;case"requestPreviousDocument":this.prev();break;case"requestNavigation":this.onRequestNavigation(t);break;case"navigateTo":this.onRequestNavigation(t)}}}},t.prototype.onAMPRuntimeDocumentLoaded=function(t){var e=this,n=this.options.version.replace(/\./g,"\\-"),i=(t.data.href||"").replace(new RegExp("(\\?|&)amp_js_v="+n,"g"),"").replace("/v/","/c/"),o=this.state.updateAMPDocByCdnUrl(i,function(t){return t.state=Qt.States.Loaded,e.state.attrs.open&&t===e.state.currentDoc&&(t.visibilityState=Qt.VisibilityStates.Visible),t});if(o&&(this.render(),!this.options.disableAnalytics)){var r=this.ampDocReports[o.cdnAmpUrl];r instanceof ge&&(r.loadEnd=(new Date).valueOf(),r.isComplete()&&this.sendAMPDocReportBeacon(r))}},t.prototype.onTouchNext=function(){this.state.next()},t.prototype.onTouchPrev=function(){this.state.prev()},t.prototype.onCloseRequest=function(){return this.options.historyEnabled?(this.window.history.go(-this.numHistoryEntriesSinceOpen),void(this.numHistoryEntriesSinceOpen=0)):this.close()},t.prototype.onIframeUnload=function(t,e){},t.prototype.onHistoryPopState=function(t){var e=this;if(t&&t.state&&"number"==typeof t.state.numHistoryEntriesSinceOpen&&(this.numHistoryEntriesSinceOpen=t.state.numHistoryEntriesSinceOpen),t&&t.isInitialCall&&(t={}),("object"==typeof t.state||null===t.state&&void 0===t.state)&&!(t&&t.state&&t.state.instanceId&&t.state.instanceId!==this.instanceId)){var n=t&&t.state||{},i=o(n,this.getStateFromUrl(this.window.location.href,n));this.skipNextUrlRender=!0,this.state.batch(function(t){i.pathPriorToOpening&&(t.attrs.isClosable||(t.attrs.isClosable=!0)),!i.open||t.attrs.open||t.attrs.enteringDOM||t.attrs.visibilitySetup?!i.open&&t.attrs.open&&(t.close(),e.numHistoryEntriesSinceOpen=0,e.didLoadPageOnAMPDoc&&e.window.location.reload()):t.open(),Array.isArray(i.docs)&&i.docs.length>0&&t.setDocs(i.docs),"number"==typeof i.currentDocIdx&&i.currentDocIdx!==t.attrs.currentDocIdx&&t.updateCurrentDocIdx(i.currentDocIdx),i.pathPriorToOpening&&(e.pathPriorToOpening=i.pathPriorToOpening)})}},t.prototype.onDOMReady=function(){var t=this.window.document;this.scrollListener.update(this.window.scrollY),this.renderTarget=this.renderTarget||t.body,this.window.addEventListener("message",this.onMessageReceived),this.state.attrs.open&&this.onOpen(),this.render(),this.onHistoryPopState({isInitialCall:!0}),this.maybeSendInitialPerformanceBeacon(),"function"==typeof this.viewerReadyCallback&&this.viewerReadyCallback(null,this)},t.prototype.onRampUpSatisfied=function(){this.sendDisableScrollToDocument()},t.prototype.onTouchEnd=function(t){this.sendEnableScrollToDocument()},t.prototype.onRequestNavigation=function(t){var e=t.data.url;this.state.emit("navigation:request",e)},t.prototype.onWindowError=function(t,e,n,i,o){if("string"==typeof e)try{var r=/amp\-viewer(\.\w+)?\.js/g.test(e||"");if(this.options.reportErrors&&r)if(e||(o.extra={wasEmptyFileName:!0}),this.isSafari()&&!o&&e&&n&&i&&(o=new Error(t),o.stack=e+":"+n+":"+i),o)this.emit("log:error",o),this.emit("log:error",o,r);else{var s={message:t,extra:{filename:e,lineNo:n,colNo:i}};this.emit("log:error",s),this.emit("log:error",s,r)}r&&!this.options.disableAnalytics&&this.emit("log:analytics",{type:"error",message:t,filename:e,lineNo:n,colNo:i}),"function"==typeof this.oldWindowError&&this.oldWindowError(t,e,n,i,o)}catch(a){this.options.reportErrors&&this.emit("log:error",a)}},t.prototype.onScroll=function(){this.scrollListener.update(this.window.scrollY)},t.prototype.onHeaderHidden=function(){this.emit("header:hide")},t.prototype.onHeaderShown=function(){this.emit("header:show")},t}();xe.defaults={numOtherDiscoveredLinksInCarousel:0,keyboardInput:!0,cdn:zt.origin,performanceBeaconSampleRate:.01,viewerOpenDelay:15,pingBeaconEndpoint:"https://amp.cloudflare.com/cdn-cgi/ping",historyEnabled:!0,canary:!1,disableBeaconPings:!1,version:"1.4.71",reportErrors:!0},xe.CarouselAnimationPlugin=pe,xe.CarouselPlugins={Clamp:be,RampUp:De,PreventSwipeOnScroll:Te,TweenToEnd:Se},xe.renderTargetActiveClass="amp-viewer-target-open",xe.metaTagViewportName="viewport",xe.metaTagViewportSelector='meta[name="'+xe.metaTagViewportName+'"]',xe.metaTagViewportContent="width=device-width,minimum-scale=1,maximum-scale=1,initial-scale=1",["on","off","emit","once"].forEach(function(t){xe.prototype[t]=function(){return this.state[t].apply(this.state,arguments),this}});var Ae="1.4.71",Ce={"boolean":yt,string:vt,number:function(t){return+t},"string[]":function(t){return t.split(",")},base64_json:wt},Ee=function(){function t(e){if(!("window"in e))throw new Gt;if("object"!=typeof e.namespace||null===e.namespace)throw new Error("ViewerRegistrar needs option: `namespace` to be an object");this.options=r(e||{},t.defaults),this.window=e.window,this.document=this.window.document,this.namespace=e.namespace,this.viewerKey=e.viewerKey,this.scriptSelector=e.scriptSelector||"script[data-amp-viewer]"}return t.coerce=function(e,n){var i=Ce[t.transferrableOptions[e]];return"function"==typeof i&&"string"==typeof n?i(n):n},t.prototype.init=function(t){var e=this;ft(this.window,function(){e.onDOMReady(),"function"==typeof t&&t(null,e)})},t.prototype.parseScriptOptions=function(){var e={window:this.window,autoDiscover:this.options.autoDiscover,version:Ae};if(this.script&&this.script.dataset){var n=this.script.dataset;for(var i in t.transferrableOptions)i in n&&(e[i]=t.coerce(i,n[i]))}if(e.viewerConfig){var o=Object.keys(e.viewerConfig).reduce(function(n,i){return n[i]=t.coerce(i,e.viewerConfig[i]),n},{});r(e,o),delete e.viewerConfig}return e.amphost&&(e.cdn="https://"+e.amphost,delete e.amphost),e},t.prototype.onDOMReady=function(){var t=this;this.script=this.document.querySelector(this.scriptSelector),this.scriptOptions=this.parseScriptOptions(),this.viewer=new xe(this.scriptOptions),this.viewer.init(function(e,n){return e?void n.emit("log:warn",{message:"Viewer Registrar failed to initialize viewer",level:"warning",extra:o({},e)}):void(Array.isArray(t.window[t.options.viewerCallbacksKey])&&t.window[t.options.viewerCallbacksKey].forEach(function(t){"function"==typeof t&&t(n)}))}),this.namespace[this.viewerKey]=this.viewer},t}();Ee.defaults={viewerKey:"ampViewer",viewerCallbacksKey:"ampViewerReady"},Ee.transferrableOptions={autoDiscover:"boolean",isOpen:"boolean",isClosable:"boolean",brandColor:"string",urls:"string[]",cdn:"string",version:"string",numOtherDiscoveredLinksInCarousel:"number",prependLinksWith:"string",listenToChangesOn:"string",parentDocumentViewerPrefix:"string",viewerConfig:"base64_json",discoveryApiKey:"string",discoveryUrl:"string",sentryDsn:"string",disableAnalytics:"boolean",beaconEndpoint:"string",pingBeaconEndpoint:"string",performanceBeaconSampleRate:"number",viewerOpenDelay:"number",domain:"string[]",blacklist:"string[]",parent:"string",historyEnabled:"boolean",canary:"boolean",discoverySelector:"string",enableAmlOnDomain:"boolean",prerenderFirstLinkAt:"number",cssUrl:"string"};var Oe=["isConstructor","isEval","isNative","isToplevel"],Pe=["columnNumber","lineNumber"],Ue=["fileName","functionName","source"],Me=["args"],ke=(Oe.concat(Pe,Ue,Me),function(){function t(t){o(this,t)}return t}()),Le=/(^|@)\S+\:\d+/,Ne=/^\s*at .*(\S+\:\d+|\(native\))/m,Re=/^(eval@)?(\[native code\])?$/,Ie=function(){function t(e){this.options=r(e,t.defaults);var n=e.dsn.substring(e.dsn.indexOf("//")+2,e.dsn.indexOf("@"));this.dsn=Y(e.dsn.replace(n+"@","")),this.dsn.auth=n,this.window=this.options.window,this.breadcrumbs=[]}return t.prototype.send=function(e,n){var i=this.getDefaultLogEntryValues();e.tags=r(e.tags||{},i.tags);var o=r(e,i);dt.post(this.getApiUrl()).set(t.authHeader,this.getAuthHeaderValue()).set("Accept","application/json").set("Content-Type","application/json").send(o).end(function(t,e){return"function"==typeof n?n(t):null}),this.breadcrumbs=[]},t.prototype.sendError=function(t,e){return this.send(this.getLogEntryFromError(t),e)},t.prototype.getLogEntryFromError=function(t){return{message:t.message,extra:t.extra,stacktrace:{frames:J(t).map(function(t){return{filename:t.fileName,"function":t.functionName,lineno:t.lineNumber,colno:t.columnNumber}}).reverse()}}},t.prototype.getDefaultLogEntryValues=function(){return{event_id:a().replace(/\-/g,""),timestamp:(new Date).toISOString(),logger:this.options.loggerName,platform:this.options.platform,sdk:{name:this.options.clientName,version:this.options.version},release:this.options.version,request:{headers:{"User-Agent":this.window.navigator.userAgent},url:this.window.location.href},breadcrumbs:{values:this.breadcrumbs},tags:this.options.tags||{}}},t.prototype.getApiUrl=function(){return this.dsn.origin+"/api"+this.dsn.pathname+"/store/"},t.prototype.getAuthHeaderValue=function(){return["Sentry sentry_version="+this.options.sentryVersion,"sentry_timestamp="+(new Date).valueOf(),"sentry_key="+this.dsn.auth,"sentry_client="+this.options.clientName+"/"+this.options.version].join(",")},t}();Ie.defaults={version:"1.4.71",sentryVersion:7,loggerName:"default",platform:"javascript",clientName:"sentry-amp-viewer"},Ie.authHeader="X-Sentry-Auth";var He=function(){function t(t){void 0===t&&(t={}),this.type="default",this.category="log",this.level="info",o(this,t),this.timestamp=this.timestamp||(new Date).toISOString()}return t}(),Ve=(function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="navigation",t}return t(n,e),n}(He),function(e){function n(){var t=null!==e&&e.apply(this,arguments)||this;return t.type="http",t}return t(n,e),n}(He),{url:"https://discovery.amp.cloudflare.com/v1/ampUrls:batchGet",blacklist:[/(\.jpg)|(\.jpeg)|(\.png)|(\.bin)|(\.mp3)|(\.gif)|(\.mkv)|(\.mp4)\|(view_img\.php\?)|(view_image\.php\?)|(\/share\?)|(\/click\/\?)|(click\?)|(submit\?)|(subscribe\.php\?)/i,"twitter.com","facebook.com","fb.com","plus.google.com","plusone.google.com","revcontent.com","play.google.com","blogger.com","youtube.com","instagram.com","itunes.apple.com","linkedin.com","doubleclick.net","pinterest.com","drive.google.com","adf.ly","stumbleupon.com","fclick-adnow.com","t.co","info.criteo.com","traffic.outbrain.com","adnxs.com","viid.me","amazon-adsystem.com","click.union.ucweb.com","n.gclick-adnow.com","accounts.google.com","downfreemp3.com","main.exoclick.com","http://www.digg.com/submit","https://www.digg.com/submit","http://www.linkedin.com/shareArticle","https://www.linkedin.com/shareArticle","http://www.stumbleupon.com/submit","https://www.stumbleupon.com/submit","http://delicious.com","https://delicious.com","http://www.tumblr.com/share/link","https://www.tumblr.com/share/link","http://bufferapp.com/add","https://bufferapp.com/add","http://getpocket.com/save","https://getpocket.com/save","http://www.evernote.com/clip.action","https://www.evernote.com/clip.action","http://reddit.com/submit","https://reddit.com/submit","https://digg.com/submit","http://digg.com/submit","http://tumblr.com/widgets/share/tool","https://tumblr.com/widgets/share/tool","http://telegram.me/share/url","https://telegram.me/share/url","i0.wp.com","i1.wp.com","i2.wp.com","s32.postimg.org","static.boredpanda.com","uploads.disquscdn.com","ugc.kn3.net","3.bp.blogspot.com","2.bp.blogspot.com","s-media-cache-ak0.pinimg.com","1.bp.blogspot.com","i.imgur.com","4.bp.blogspot.com","pbs.twimg.com","cdns.klimg.com","videoup.net","rtb.4finance.com","www.amazon.com","plusone.google.com","m.addthis.com","www.google.com/searchbyimage","i.w55c.net","a.tribalfusion.com","code.yengo.com","clk.tradedoubler.com","get.kixer.com","www.collarchat.com","www.viidii.info","beap.gemini.yahoo.com","www.addtoany.com","share.v.t.qq.com","revclouds.com"]}),_e=function(){function t(e){this.options=r(e||{},t.defaults),this.urls=this.options.urls||[],this.nodes=this.options.nodes||[],this.resultUrls={}}return t.getDiscovererFromElement=function(e,n){var i=t.getNodeList(e,n.selector).filter(function(t){return 0===t.href.indexOf("http")}).filter(function(t,e,i){return"function"!=typeof n.filter||n.filter(t,e,i)}),r=i.map(function(t){return t.href});return new t(o({urls:r,nodes:i},n))},t.getNodeList=function(e,n){return void 0===n&&(n=t.selector),Array.prototype.slice.call(e.querySelectorAll(n))},t.prototype.getResultFromBody=function(t){return"ampUrls"in t?(t.ampUrls||[]).reduce(function(t,e){return o(t,(n={},n[e.originalUrl]=e,n));var n},{}):"urls"in t?t.urls:{}},t.prototype.discover=function(e){var n=this,i=this.urls.filter(function(t,e,n){return n.indexOf(t,e+1)===-1});return 0===i.length?e(null,{}):void mt.post(this.options.discoveryUrl).set("Content-Type","application/json").query({key:this.options.apiKey||""}).send({urls:i,lookupStrategy:t.lookupStrategy}).withCredentials().end(function(t,o){return t?(t.urls=i,o&&(t.status=o.status,t.responseBody=o.body,t.responseHeaders=o.header),e(t)):(n.resultUrls=n.getResultFromBody(o.body),e(null,n.resultUrls))})},t}();_e.lookupStrategy="IN_INDEX_DOC",_e.defaults={discoveryUrl:Ve.url},_e.selector='a[href]:not([rel="nofollow"])';var Fe=function(){function t(e){this.options=r(e,t.defaults),this.options.discoveryApiKey=this.options.discoveryApiKey||rt([this.options.viewer.window.location.hostname].concat(this.options.parent?[this.options.parent]:[]).join(":")),this.scrollListener=new ye,this.onDocumentClick=this.onDocumentClick.bind(this),this.onElementMutation=this.onElementMutation.bind(this),this.onScroll=this.onScroll.bind(this)}return t.prototype.init=function(){var t=this,e=this.options.viewer;this.onScroll(),e.window.addEventListener("scroll",this.onScroll),ft(e.window,function(){return t.onDOMReady()})},t.prototype.destroy=function(){var t=this.options.viewer;t.window.removeEventListener("scroll",this.onScroll)},t.prototype.getUrlsFromTarget=function(t){for(var e=this.options.viewer,n=this.discoverer.nodes.indexOf(t),i=e.options.numOtherDiscoveredLinksInCarousel+1,o={},r=[],s=n;r.length<i&&s<this.discoverer.urls.length;s++){var a=this.discoverer.urls[s];a in this.ampCacheMap&&(a in o||(r.push(this.ampCacheMap[a]),o[a]=!0))}return r},t.prototype.discover=function(){var e=this,n=this.options.viewer;this.discoverer=_e.getDiscovererFromElement(n.renderTarget,{selector:this.options.discoverySelector,discoveryUrl:this.options.discoveryUrl,apiKey:this.options.discoveryApiKey,filter:function(i){if(p(i,n.component))return!1;var o=Y(i.href);if(!o.hostname)return!1;if(o.hostname.indexOf(".")<1||o.hostname.indexOf(".")==o.hostname.length-1)return!1;if(e.options.domain){var r=o.hostname,s=e.options.domain,a=(e.options.blacklist||[]).concat(e.options.enableAmlOnDomain?[]:s);t.alwaysBlacklist.length>0&&(a=a.concat(t.alwaysBlacklist));var c=a.every(function(t){if(t instanceof RegExp)return!t.test(i.href);if(t.indexOf("/")>-1)return 0!==(i.href||"").trim().indexOf(t);var e=(r||"").trim();return e.substring(e.indexOf(t))!==t});if(!c)return c}return!!e.options.enableAmlOnDomain||o.origin!==n.window.location.origin}}),this.options.viewer.discoverer=this.discoverer,this.discoverer.discover(function(t,i){if(t)return void n.emit("log:warn",{message:"A call to the discovery service failed",level:"warning",extra:{url:t.url,urls:t.urls,message:t.message,status:t.status,responseBody:t.responseBody,responseHeaders:t.responseHeaders}});if(e.options.prependLinksWith&&Array.prototype.slice.call(_e.getNodeList(n.renderTarget,e.options.discoverySelector)).filter(function(t){return t.href in i}).forEach(function(t){0!==t.innerHTML.indexOf(e.options.prependLinksWith)&&(t.innerHTML=""+e.options.prependLinksWith+t.innerHTML)}),e.ampCacheMap=i,0===n.state.attrs.docs.length){var o=function(){for(var t=0;t<e.discoverer.nodes.length;t++)if(e.discoverer.nodes[t].href in e.ampCacheMap)return e.discoverer.nodes[t]}();if(o){e.prerenderedAnchor=o;var r=o.offsetTop-n.window.innerHeight-e.options.prerenderFirstLinkAt;e.prerenderScrollHandler=e.scrollListener.once(r,function(){n.state.setDocsFromDiscoveryResult(e.getUrlsFromTarget(o))})}}"function"==typeof e.options.onDiscoveryComplete&&(e.options.onDiscoveryComplete(e.options.viewer),e.options.viewer.emit("discovery:complete",i))})},t.prototype.onDocumentClick=function(t){for(var e=10,n=t.target,i=0;n&&"A"!==n.tagName&&i++<e;)n=n.parentElement;if(n&&"A"===n.tagName&&n.href in this.ampCacheMap&&!p(n,this.options.viewer.component)){t.preventDefault(),t.stopPropagation();var o=this.options.viewer;if(!this.options.disableAnalytics){var r={type:"ampLinkClick",url:this.ampCacheMap[n.href].cdnAmpUrl,createdAt:(new Date).valueOf()};this.prerenderedAnchor===n&&(r.wasPrerender=!0),o.emit("log:analytics",r)}return o.state.setDocsFromDiscoveryResult(this.getUrlsFromTarget(n)),0===o.options.viewerOpenDelay?o.state.open():o.window.setTimeout(function(){return o.state.open()},o.options.viewerOpenDelay),t.returnValue=!1,!1}},t.prototype.onScroll=function(){this.scrollListener.update(this.options.viewer.window.scrollY)},t.prototype.onDOMReady=function(){var t=this.options.viewer.window.document;t.addEventListener("click",this.onDocumentClick,{capture:!0}),this.options.listenToChangesOn&&"undefined"!=typeof MutationObserver&&(this.mutationEl=t.querySelector(this.options.listenToChangesOn),this.mutationEl&&(this.mutationObserver=new MutationObserver(this.onElementMutation),this.mutationObserver.observe(this.mutationEl,{childList:!0,subtree:!0}))),this.options.autoDiscover&&this.discover()},t.prototype.onElementMutation=function(t){0!==t.length&&this.discover()},t}();Fe.defaults={disableAnalytics:!1,autoDiscover:!0,onDiscoveryComplete:function(){},prependLinksWith:'<span class="amp-viewer-amp-logo-icon"></span> ',listenToChangesOn:".js-site-wrapper",prerenderFirstLinkAt:50},Fe.alwaysBlacklist=Ve.blacklist;var Be=function(){function t(e){this.options=r(e,t.defaults),this.navigator=this.options.navigator,this.req=dt}return t.prototype.getQueryParams=function(){return{be_tok:this.options.key,req_id:this.options.id||a()}},t.prototype.send=function(e){if(!("sendBeacon"in this.navigator))return this.sendXHR(e);var n=ut.prototype.getQueryString.call({details:{query:this.getQueryParams()}}),i=""+this.options.endpoint+n;return this.navigator.sendBeacon(i,new Blob([JSON.stringify(this.options.data)],t.beaconBlobOptions)),"function"==typeof e&&e(),this},t.prototype.sendXHR=function(t){return dt.post(this.options.endpoint).set("Accept","*/*").set("Content-Type","application/json").query(this.getQueryParams()).send(this.options.data).end(function(e){"function"==typeof t&&t(e)}),this},t}();Be.defaults={endpoint:"/cdn-cgi/beacon/amp"},Be.beaconBlobOptions={type:"application/json"};var qe=function(){function t(t){this.window=t.window,this.url=t.url||"/cdn-cgi/ping",this.data=t.data||{}}return t.prototype.beacon=function(t){return new We(this.window,o(t,this.data),this.url)},t}(),We=function(){function t(t,e,n){this.window=t,this.data=e||{},this.ts=(new Date).valueOf().toString(),this.data.ts=this.ts,this.url=n||"/cdn-cgi/ping"}return t.prototype.getQueryString=function(){var t=this.data;return Object.keys(this.data).map(function(e){return[e,t[e]].map(function(t){return encodeURIComponent(t)}).join("=")}).join("&")},t.prototype.send=function(){var t=this.window.document.createElement("img");t.src=this.url+"?"+this.getQueryString()},t}(),je=function(t){return new xe(t)},ze=(c()||[])[0];if("number"!=typeof ze||ze>8){var Ke=new Ee({window:window,namespace:window});Ke.init(function(t){var e=Ke.viewer,n=e.options.version.replace(/\./g,"-"),i=Ke.scriptOptions.cssUrl||e.options.cdn+"/viewer/rtv/01"+n+"/amp-viewer.css";if(e.on("navigation:request",function(t){window.location.href=t}),Ke.scriptOptions.sentryDsn){var r=new Ie({dsn:Ke.scriptOptions.sentryDsn||"https://1d608de49786426e9ff32adc56eeb2bd@sentry.io/110891",window:window,tags:{zone:window.location.hostname,canary:Ke.scriptOptions.canary.toString()}});e.on("log:warn",function(t){return r.send(t)}),e.on("log:error",function(t){t instanceof Error?r.sendError(t):r.send(t)})}if(!Ke.scriptOptions.disableAnalytics){var s=Ke.scriptOptions,a=new qe({window:window,url:s.pingBeaconEndpoint,data:{parent:s.parent,domain:s.domain.join(","),version:s.version,canary:s.canary}});e.on("log:analytics",function(t){a.beacon(t).send()})}var c=new Fe(o({viewer:e},Ke.scriptOptions));c.init(),window.document.querySelector('link[href="'+i+'"]')||setTimeout(function(){var t=window.document.createElement("link");t.rel="stylesheet",t.href=i,window.document.head.appendChild(t)},1e3),e.viewerDiscovery=c})}return je}();
//# sourceMappingURL=amp-viewer.js.map
